#include <gtest/gtest.h>

#include "net/quic_utils.h"
#include "vpn/internal/domain_lookuper.h"

using namespace ag;

struct TestParam {
    std::vector<uint8_t> input;
    DomainLookuperPacketDirection dir;
    DomainLookuperStatus expected_status;
    std::string expected_domain;
};

class OutgoingDataTcp : public testing::TestWithParam<TestParam> {
public:
    DomainLookuper lookuper = {};
    DomainLookuperResult result = {};

    static void SetUpTestSuite() {
        ag::Logger::set_log_level(ag::LOG_LEVEL_TRACE);
    }

    void SetUp() override {
        result = {};
    }
};

TEST_P(OutgoingDataTcp, Test) {
    const TestParam &param = GetParam();

    result = lookuper.proceed(param.dir, IPPROTO_TCP, (uint8_t *) param.input.data(), param.input.size());

    ASSERT_EQ(result.status, param.expected_status) << result.domain;
    ASSERT_EQ(result.domain, param.expected_domain);
}

class OutgoingDataUdp : public testing::TestWithParam<TestParam> {
public:
    DomainLookuper lookuper = {};
    DomainLookuperResult result = {};

    static void SetUpTestSuite() {
        ag::Logger::set_log_level(ag::LOG_LEVEL_TRACE);
    }

    void SetUp() override {
        result = {};
    }
};

TEST_P(OutgoingDataUdp, Test) {
    const TestParam &param = GetParam();

    auto quic_header = ag::quic_utils::parse_quic_header({param.input.data(), param.input.size()});
    ASSERT_TRUE(quic_header);
    auto data =
            ag::quic_utils::prepare_for_domain_lookup({param.input.data(), param.input.size()}, quic_header.value());
    ASSERT_TRUE(data);
    result = lookuper.proceed(param.dir, IPPROTO_UDP, data->data(), data->size());

    ASSERT_EQ(result.status, param.expected_status) << result.domain;
    ASSERT_EQ(result.domain, param.expected_domain);
}

static std::vector<uint8_t> string_view_to_vector(std::string_view str) {
    return std::vector<uint8_t>{(uint8_t *) str.data(), (uint8_t *) str.data() + str.length() + 1};
}

static int parse_hex_char(int c) {
    if (c >= '0' && c <= '9') {
        return c - 0x30;
    }
    if (c >= 'a' && c <= 'f') {
        return c - 0x57;
    }
    if (c >= 'A' && c <= 'F') {
        return c - 0x37;
    }
    return -1;
}

static std::vector<uint8_t> decode_from_hex(std::string_view hex) {
    if (hex.size() & 1) {
        return {};
    }
    std::vector<uint8_t> result;
    result.reserve(hex.size() >> 1);
    for (size_t i = 0; i < hex.size(); i += 2) {
        int hi = parse_hex_char(hex[i]);
        int lo = parse_hex_char(hex[i + 1]);
        if (hi < 0 || lo < 0) {
            return {};
        }
        result.push_back((uint8_t) (hi << 4 | lo));
    }
    return result;
}

static const TestParam QUIC_TEST_SAMPLES[] = {
        {// client hello sni=example.com; quic version draft 34
                decode_from_hex("c000000001088394c8f03e5157080000449e7b9aec34d1b1c98dd7689fb8ec11"
                                "d242b123dc9bd8bab936b47d92ec356c0bab7df5976d27cd449f63300099f399"
                                "1c260ec4c60d17b31f8429157bb35a1282a643a8d2262cad67500cadb8e7378c"
                                "8eb7539ec4d4905fed1bee1fc8aafba17c750e2c7ace01e6005f80fcb7df6212"
                                "30c83711b39343fa028cea7f7fb5ff89eac2308249a02252155e2347b63d58c5"
                                "457afd84d05dfffdb20392844ae812154682e9cf012f9021a6f0be17ddd0c208"
                                "4dce25ff9b06cde535d0f920a2db1bf362c23e596d11a4f5a6cf3948838a3aec"
                                "4e15daf8500a6ef69ec4e3feb6b1d98e610ac8b7ec3faf6ad760b7bad1db4ba3"
                                "485e8a94dc250ae3fdb41ed15fb6a8e5eba0fc3dd60bc8e30c5c4287e53805db"
                                "059ae0648db2f64264ed5e39be2e20d82df566da8dd5998ccabdae053060ae6c"
                                "7b4378e846d29f37ed7b4ea9ec5d82e7961b7f25a9323851f681d582363aa5f8"
                                "9937f5a67258bf63ad6f1a0b1d96dbd4faddfcefc5266ba6611722395c906556"
                                "be52afe3f565636ad1b17d508b73d8743eeb524be22b3dcbc2c7468d54119c74"
                                "68449a13d8e3b95811a198f3491de3e7fe942b330407abf82a4ed7c1b311663a"
                                "c69890f4157015853d91e923037c227a33cdd5ec281ca3f79c44546b9d90ca00"
                                "f064c99e3dd97911d39fe9c5d0b23a229a234cb36186c4819e8b9c5927726632"
                                "291d6a418211cc2962e20fe47feb3edf330f2c603a9d48c0fcb5699dbfe58964"
                                "25c5bac4aee82e57a85aaf4e2513e4f05796b07ba2ee47d80506f8d2c25e50fd"
                                "14de71e6c418559302f939b0e1abd576f279c4b2e0feb85c1f28ff18f58891ff"
                                "ef132eef2fa09346aee33c28eb130ff28f5b766953334113211996d20011a198"
                                "e3fc433f9f2541010ae17c1bf202580f6047472fb36857fe843b19f5984009dd"
                                "c324044e847a4f4a0ab34f719595de37252d6235365e9b84392b061085349d73"
                                "203a4a13e96f5432ec0fd4a1ee65accdd5e3904df54c1da510b0ff20dcc0c77f"
                                "cb2c0e0eb605cb0504db87632cf3d8b4dae6e705769d1de354270123cb11450e"
                                "fc60ac47683d7b8d0f811365565fd98c4c8eb936bcab8d069fc33bd801b03ade"
                                "a2e1fbc5aa463d08ca19896d2bf59a071b851e6c239052172f296bfb5e724047"
                                "90a2181014f3b94a4e97d117b438130368cc39dbb2d198065ae3986547926cd2"
                                "162f40a29f0c3c8745c0f50fba3852e566d44575c29d39a03f0cda721984b6f4"
                                "40591f355e12d439ff150aab7613499dbd49adabc8676eef023b15b65bfc5ca0"
                                "6948109f23f350db82123535eb8a7433bdabcb909271a6ecbcb58b936a88cd4e"
                                "8f2e6ff5800175f113253d8fa9ca8885c2f552e657dc603f252e1a8e308f76f0"
                                "be79e2fb8f5d5fbbe2e30ecadd220723c8c0aea8078cdfcb3868263ff8f09400"
                                "54da48781893a7e49ad5aff4af300cd804a6b6279ab3ff3afb64491c85194aab"
                                "760d58a606654f9f4400e8b38591356fbf6425aca26dc85244259ff2b19c41b9"
                                "f96f3ca9ec1dde434da7d2d392b905ddf3d1f9af93d1af5950bd493f5aa731b4"
                                "056df31bd267b6b90a079831aaf579be0a39013137aac6d404f518cfd4684064"
                                "7e78bfe706ca4cf5e9c5453e9f7cfd2b8b4c8d169a44e55c88d4a9a7f9474241"
                                "e221af44860018ab0856972e194cd934"),
                DLUPD_OUTGOING, DLUS_FOUND, "example.com"},
        {// client hello sni=quic.nginx.org; quic version 1
                decode_from_hex("c300000001089714ce4dc712435c000045349815f4232d1334276442f35"
                                "fa3505fa9fbbafc0d57c8e502d00ff976b3acc29aeaecb9ac05f9861fc75cf6c"
                                "4656b818abecce1475d238c7caef9d0a88c9bc8b45663d79972659808ec72f8e"
                                "e85dc903c3bcbf37267a7e3a96ab3d454ba77585dc39b90bdd19c76beee20cfb"
                                "dd929fb7c7da5664326811139e9dc891af87f19c497cf18b4b4de4c6fe2b4e96"
                                "270c9e2ec0822837a47228e3832677249e30b0f592333d7f7a4becbf74dc461e"
                                "2acf6f1278f7da5b804a951dae714382e7cbfde731213c92c59b2220d3911d7f"
                                "2daa31cc60779e9971e4a9814d510d83a79a66f1a9731cd8df40f01012c629a8"
                                "97e392c83bb2464c2c54141a5310868d00ae0a60ea95232769681c64c95d5599"
                                "00542dbe0bbacc242952fd5cbe42ba69689b4e9e3c1fe639f6e1e2d50e7b13f4"
                                "295c56eaec82bb14eb1bc9390c045e4e0e97b8ebe93cd5a20dd7cd83c6de5cd5"
                                "9210f9c33f7ee874e450c478ea4a359ff00a8286f7ac1f18a4b2af0ffc942725"
                                "af362a817dd92a1dbc9fddeb2c1d5c7dff05a4c985c78b02e35466d3b36a28d5"
                                "a9ce1eea14f215f431051663e88e7cd7e6c36f90d45a21a97c3b8e7705c95f72"
                                "f99c6dc4af04690582a57ff50bc3762f15dfa71322db1ce1aabe8c298455aec9"
                                "a644bccaa9347a9d186ec2801512ed827818cf3eba0781bdf09114d677acdbd0"
                                "665f5e5cbb79219488b742d37085de9079e51e92ffec7d2c7fcb2d3e02303dad"
                                "4eda0154cdd3c9f5f95c1533358d3299d7255c16e862276c4dea10667522c771"
                                "d5dca113fe03421e7e89ccddf44c3926163f5a40685b8f85b6f139b334b1f40e"
                                "d42235b9d9df77070f40ff9d8382e3338249a86c799e7748dc8ac74035584d23"
                                "e6c487fb3c5a36bdaae76fd2929a7ca43c064bfdcde5cd1b51f32cca66f27f19"
                                "b79dbf76d888afc47d313b476f5d4765f92f81becd996b36c5845eaef3f2b602"
                                "296ff7885cba127fcb2c161ffd87e4c32229c8e287de99699500ac2f8a8484a5"
                                "2b6f143cb429f36f73a2499f32896730da7b2c816256142daf623d28199ba9a6"
                                "4619205d6bca37e2fa2c201690607039589a314c305fe1d543647dacd252c8b9"
                                "d0c19cbf12d35157159d56da33c4c78925fcd4c516eb98b35ea80ad96198cc35"
                                "cdf817e917b99a82dc0e72482ca213c249b928017ccf73d3322ee021b84d6275"
                                "04312eae53d899bf6c5db3a4e9565428be6256e11c1e03fa2b603c810687f8cc"
                                "5a473d97bae95c82b26645d8e6e5b207545e6709ed649f6782626a61d48e2c6c"
                                "9d3c167f95fcf15596278fb5b715d6e6e7f50bee7af25580ff36fd174d9d2b61"
                                "e23c1a59bcd4509d6d169d12304c08827e298b5d3fdd85b8af0a7658e5c480b7"
                                "2ba20b79a09e5667091e52d587d44b1987e2c0c78f99ab5d4cbba87ba02eaaf7"
                                "aa9aa344c98163b6d11373a88c999737b29fbe8647077000903097417366c615"
                                "30802b1ee8224ea343c686226277300c446bc7266c70c9c66aba23764d7387d4"
                                "5241d3981854f6d97d3a7ab49c271e28128b13fa5f4a38647056a18ba6b2f90f"
                                "4432fd58e5d4fd5233a4c5087e5f904ba7dfb2b5074ee27578f78d24f180be5a"
                                "b4f480e0e93f5d20e594730eae7fd2a1fab7c306530d4c6b590a52ae15f270a0"
                                "b6e65075e63b0b6d1f6ca7770caa1ce698e15e9b2867292ddeb820c1fa926028"
                                "92d0469126e5a2f7d4e5c99f6b6afcc3097f06e47acc93454ba83e3250741860"
                                "3cbdb338b39c35b4703dfb016aeb2d57dce036e6261999e28778b89089b9370d"
                                "699046673647ed84f9a5271cd5ef73c09870d955b37b464ef6a8d79e8d7bb301"
                                "5f17e869fa064dde2cbc9f38e58a0116a9b148b6ef56796d72e1994d1bfc1060"
                                "44d00d350ffb602fc"),
                DLUPD_OUTGOING, DLUS_FOUND, "quic.nginx.org"},
};

INSTANTIATE_TEST_SUITE_P(DomainLookuperQuic, OutgoingDataUdp, testing::ValuesIn(QUIC_TEST_SAMPLES));

static const TestParam HTTP_TEST_SAMPLES[] = {
        {string_view_to_vector("GET / HTTP/1.1\r\nAccept: text/html\r\nHost: example.com\r\n\r\n"), DLUPD_OUTGOING,
                DLUS_FOUND, "example.com"},
        {string_view_to_vector("GET / HTTP/1.1\r\nAccept: text/html\r\nHost:example.com\r"), DLUPD_OUTGOING, DLUS_FOUND,
                "example.com"},
        {string_view_to_vector(
                 "GET / HTTP/1.1\r\nAccept: text/html\r\nHost:   example.com\r\nAccept: text/html\r\n\r\n"),
                DLUPD_OUTGOING, DLUS_FOUND, "example.com"},
        {string_view_to_vector("CONNECT http://example.com/ HTTP/1.1\r\nAccept: text/html\r\n\r\n"), DLUPD_OUTGOING,
                DLUS_FOUND, "example.com"},
        {string_view_to_vector("CONNECT http://example.com:80/ HTTP/1.1\r\nAccept: text/html\r\n\r\n"), DLUPD_OUTGOING,
                DLUS_FOUND, "example.com"},
        {string_view_to_vector("CONNECT example.com HTTP/1.1\r\nAccept: text/html\r\n\r\n"), DLUPD_OUTGOING, DLUS_FOUND,
                "example.com"},

        {string_view_to_vector("GET / HTTP/1.1\r\nAccept: text/html\r\nHo: example.com\r\n\r\n"), DLUPD_OUTGOING,
                DLUS_NOTFOUND, ""},
        {string_view_to_vector("GET / HTTP/1.1\r\nAccept: text/html\r\nHo: example.com"), DLUPD_OUTGOING, DLUS_NOTFOUND,
                ""},
        {string_view_to_vector("GET / HTTP/1.1\r\nAccept: text"), DLUPD_OUTGOING, DLUS_NOTFOUND, ""},
        {string_view_to_vector("CONNECT /example HTTP/1.1\r\nAccept: text/html\r\n\r\n"), DLUPD_OUTGOING, DLUS_NOTFOUND,
                ""},
        {string_view_to_vector("CONNECT example.com"), DLUPD_OUTGOING, DLUS_NOTFOUND, ""},
};
INSTANTIATE_TEST_SUITE_P(DomainLookuperHTTP, OutgoingDataTcp, testing::ValuesIn(HTTP_TEST_SAMPLES));

static const TestParam TLS_TEST_SAMPLES[] = {
        {// client hello sni=localhost
                {0x16, 0x03, 0x01, 0x01, 0x3E, 0x01, 0x00, 0x01, 0x3A, 0x03, 0x03, 0x0C, 0xC1, 0x18, 0xB3, 0x53, 0xC8,
                        0x9A, 0xCB, 0xDB, 0xB7, 0x40, 0x60, 0xB0, 0x7C, 0x2E, 0xC0, 0x5E, 0xBB, 0xD4, 0x58, 0x4D, 0xBC,
                        0x77, 0xE4, 0x4E, 0x35, 0xD3, 0x25, 0x73, 0x34, 0xF8, 0xF7, 0x00, 0x00, 0xAA, 0xC0, 0x30, 0xC0,
                        0x2C, 0xC0, 0x28, 0xC0, 0x24, 0xC0, 0x14, 0xC0, 0x0A, 0x00, 0xA5, 0x00, 0xA3, 0x00, 0xA1, 0x00,
                        0x9F, 0x00, 0x6B, 0x00, 0x6A, 0x00, 0x69, 0x00, 0x68, 0x00, 0x39, 0x00, 0x38, 0x00, 0x37, 0x00,
                        0x36, 0x00, 0x88, 0x00, 0x87, 0x00, 0x86, 0x00, 0x85, 0xC0, 0x32, 0xC0, 0x2E, 0xC0, 0x2A, 0xC0,
                        0x26, 0xC0, 0x0F, 0xC0, 0x05, 0x00, 0x9D, 0x00, 0x3D, 0x00, 0x35, 0x00, 0x84, 0xC0, 0x2F, 0xC0,
                        0x2B, 0xC0, 0x27, 0xC0, 0x23, 0xC0, 0x13, 0xC0, 0x09, 0x00, 0xA4, 0x00, 0xA2, 0x00, 0xA0, 0x00,
                        0x9E, 0x00, 0x67, 0x00, 0x40, 0x00, 0x3F, 0x00, 0x3E, 0x00, 0x33, 0x00, 0x32, 0x00, 0x31, 0x00,
                        0x30, 0x00, 0x9A, 0x00, 0x99, 0x00, 0x98, 0x00, 0x97, 0x00, 0x45, 0x00, 0x44, 0x00, 0x43, 0x00,
                        0x42, 0xC0, 0x31, 0xC0, 0x2D, 0xC0, 0x29, 0xC0, 0x25, 0xC0, 0x0E, 0xC0, 0x04, 0x00, 0x9C, 0x00,
                        0x3C, 0x00, 0x2F, 0x00, 0x96, 0x00, 0x41, 0xC0, 0x11, 0xC0, 0x07, 0xC0, 0x0C, 0xC0, 0x02, 0x00,
                        0x05, 0x00, 0x04, 0xC0, 0x12, 0xC0, 0x08, 0x00, 0x16, 0x00, 0x13, 0x00, 0x10, 0x00, 0x0D, 0xC0,
                        0x0D, 0xC0, 0x03, 0x00, 0x0A, 0x00, 0xFF, 0x01, 0x00, 0x00, 0x67, 0x00, 0x00, 0x00, 0x0E, 0x00,
                        0x0C, 0x00, 0x00, 0x09, 0x6C, 0x6F, 0x63, 0x61, 0x6C, 0x68, 0x6F, 0x73, 0x74, 0x00, 0x0B, 0x00,
                        0x04, 0x03, 0x00, 0x01, 0x02, 0x00, 0x0A, 0x00, 0x1C, 0x00, 0x1A, 0x00, 0x17, 0x00, 0x19, 0x00,
                        0x1C, 0x00, 0x1B, 0x00, 0x18, 0x00, 0x1A, 0x00, 0x16, 0x00, 0x0E, 0x00, 0x0D, 0x00, 0x0B, 0x00,
                        0x0C, 0x00, 0x09, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x00, 0x00, 0x0D, 0x00, 0x20, 0x00, 0x1E, 0x06,
                        0x01, 0x06, 0x02, 0x06, 0x03, 0x05, 0x01, 0x05, 0x02, 0x05, 0x03, 0x04, 0x01, 0x04, 0x02, 0x04,
                        0x03, 0x03, 0x01, 0x03, 0x02, 0x03, 0x03, 0x02, 0x01, 0x02, 0x02, 0x02, 0x03, 0x00, 0x0F, 0x00,
                        0x01, 0x01},
                DLUPD_OUTGOING, DLUS_FOUND, "localhost"},
        {// client hello no sni
                {0x16, 0x03, 0x01, 0x01, 0x2C, 0x01, 0x00, 0x01, 0x28, 0x03, 0x03, 0x77, 0xB6, 0x93, 0xFB, 0xA0, 0xE5,
                        0x3F, 0xA2, 0x3E, 0x44, 0x04, 0x1B, 0x54, 0x18, 0x44, 0x1B, 0x1D, 0x16, 0x27, 0x6B, 0x73, 0x2B,
                        0xBE, 0xDC, 0x38, 0xA2, 0x88, 0xAB, 0x9E, 0x4D, 0xC2, 0x7E, 0x00, 0x00, 0xAA, 0xC0, 0x30, 0xC0,
                        0x2C, 0xC0, 0x28, 0xC0, 0x24, 0xC0, 0x14, 0xC0, 0x0A, 0x00, 0xA5, 0x00, 0xA3, 0x00, 0xA1, 0x00,
                        0x9F, 0x00, 0x6B, 0x00, 0x6A, 0x00, 0x69, 0x00, 0x68, 0x00, 0x39, 0x00, 0x38, 0x00, 0x37, 0x00,
                        0x36, 0x00, 0x88, 0x00, 0x87, 0x00, 0x86, 0x00, 0x85, 0xC0, 0x32, 0xC0, 0x2E, 0xC0, 0x2A, 0xC0,
                        0x26, 0xC0, 0x0F, 0xC0, 0x05, 0x00, 0x9D, 0x00, 0x3D, 0x00, 0x35, 0x00, 0x84, 0xC0, 0x2F, 0xC0,
                        0x2B, 0xC0, 0x27, 0xC0, 0x23, 0xC0, 0x13, 0xC0, 0x09, 0x00, 0xA4, 0x00, 0xA2, 0x00, 0xA0, 0x00,
                        0x9E, 0x00, 0x67, 0x00, 0x40, 0x00, 0x3F, 0x00, 0x3E, 0x00, 0x33, 0x00, 0x32, 0x00, 0x31, 0x00,
                        0x30, 0x00, 0x9A, 0x00, 0x99, 0x00, 0x98, 0x00, 0x97, 0x00, 0x45, 0x00, 0x44, 0x00, 0x43, 0x00,
                        0x42, 0xC0, 0x31, 0xC0, 0x2D, 0xC0, 0x29, 0xC0, 0x25, 0xC0, 0x0E, 0xC0, 0x04, 0x00, 0x9C, 0x00,
                        0x3C, 0x00, 0x2F, 0x00, 0x96, 0x00, 0x41, 0xC0, 0x11, 0xC0, 0x07, 0xC0, 0x0C, 0xC0, 0x02, 0x00,
                        0x05, 0x00, 0x04, 0xC0, 0x12, 0xC0, 0x08, 0x00, 0x16, 0x00, 0x13, 0x00, 0x10, 0x00, 0x0D, 0xC0,
                        0x0D, 0xC0, 0x03, 0x00, 0x0A, 0x00, 0xFF, 0x01, 0x00, 0x00, 0x55, 0x00, 0x0B, 0x00, 0x04, 0x03,
                        0x00, 0x01, 0x02, 0x00, 0x0A, 0x00, 0x1C, 0x00, 0x1A, 0x00, 0x17, 0x00, 0x19, 0x00, 0x1C, 0x00,
                        0x1B, 0x00, 0x18, 0x00, 0x1A, 0x00, 0x16, 0x00, 0x0E, 0x00, 0x0D, 0x00, 0x0B, 0x00, 0x0C, 0x00,
                        0x09, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x00, 0x00, 0x0D, 0x00, 0x20, 0x00, 0x1E, 0x06, 0x01, 0x06,
                        0x02, 0x06, 0x03, 0x05, 0x01, 0x05, 0x02, 0x05, 0x03, 0x04, 0x01, 0x04, 0x02, 0x04, 0x03, 0x03,
                        0x01, 0x03, 0x02, 0x03, 0x03, 0x02, 0x01, 0x02, 0x02, 0x02, 0x03, 0x00, 0x0F, 0x00, 0x01, 0x01},
                DLUPD_OUTGOING, DLUS_PASS, ""},
        {// bad client hello
                {0x16, 0x03, 0x01, 0x00, 0xd5, 0x01, 0x00, 0x03, 0x11, 0xda, 0xf5, 0x00, 0x01, 0xd6, 0x00, 0x74, 0x00,
                        0x00, 0x38, 0x40, 0x01, 0x00, 0xc7, 0x00, 0x2d, 0x00, 0x00, 0x00, 0x2f, 0x00, 0x36, 0x00, 0x43,
                        0x00, 0xb2, 0x00, 0x2b, 0x42, 0x7b, 0xc5, 0x9a, 0x63, 0xcc, 0xb1, 0x94, 0x53, 0x71, 0x99, 0x58,
                        0xaa, 0x9c, 0x8a, 0x9b, 0x30, 0xee, 0xed, 0x12, 0x05, 0x0d, 0xc9, 0xc3, 0x9f, 0xea, 0xd5, 0x16,
                        0x55, 0x3f, 0x21, 0xe7, 0x79, 0x03, 0x46, 0x72, 0xdf, 0xf2, 0xae, 0xbc, 0x84, 0x8e, 0xe2, 0x3a,
                        0x86, 0x98, 0x4b, 0x5a, 0x83, 0xf7, 0xb3, 0x27, 0x67, 0x19, 0x25, 0x4a, 0x24, 0x51, 0x9b, 0xfc,
                        0x1b, 0x32, 0x65, 0x8f, 0xf6, 0xdf, 0x4d, 0xc8, 0x74, 0xec, 0x71, 0x95, 0xb4, 0xde, 0x3a, 0xf5,
                        0x89, 0xc0, 0xf2, 0x5f, 0xcd, 0x0b, 0xf2, 0x29, 0x09, 0xcd, 0x99, 0x20, 0xef, 0x19, 0x55, 0x5d,
                        0xf5, 0x28, 0x10, 0x27, 0xd2, 0x54, 0x02, 0x2a, 0xca, 0x1f, 0xbc, 0xc3, 0xc7, 0xfb, 0x3b, 0xff,
                        0x73, 0x74, 0x79, 0x4f, 0x8f, 0xbd, 0x12, 0x27, 0x86, 0xfc, 0xa1, 0x13, 0xd0, 0x33, 0x81, 0x21,
                        0x65, 0x54, 0x23, 0x02, 0xf0, 0x83, 0x22, 0xcd, 0x7e, 0xdd, 0x02, 0xc4, 0x87, 0x53, 0x29, 0x5d,
                        0x24, 0xcc, 0x56, 0xd5, 0x70, 0xa3, 0x3d, 0x12, 0x88, 0x94, 0x0f, 0xa0, 0x75, 0x9b, 0x12, 0x58,
                        0x2a, 0xc0, 0x79, 0x55, 0xe6, 0xe4, 0x41, 0x46, 0x95, 0xd9, 0x44, 0xc4, 0xb5, 0x73, 0xf5, 0x06,
                        0x65, 0x61, 0xdf, 0x2c, 0x84, 0xa8, 0x3f, 0x62, 0x4f, 0xa6, 0x32, 0xac, 0x31, 0x88, 0x54, 0x2e,
                        0x91, 0x5c, 0x5e, 0x39, 0x17, 0x99, 0x09, 0x97, 0x00, 0x29, 0x7e, 0xbc, 0x9b, 0x29, 0x72, 0xd0,
                        0x72, 0x57, 0x08, 0xcc, 0xfa, 0xf5, 0x5f, 0x8b, 0x6c, 0xcb, 0x23, 0x69, 0xbd, 0x02, 0x13, 0x12,
                        0x3f, 0x31, 0x8e, 0x3a, 0x4b, 0x65, 0xd1, 0xe6, 0x4e, 0xb0, 0x40, 0x21, 0x07, 0x6f, 0xaa, 0x89,
                        0x5d, 0x0c, 0x0e, 0xfb, 0xeb, 0xfe, 0xda, 0xed, 0x6f, 0xb4, 0xf5, 0xfc, 0x47, 0x06, 0x36, 0xa9,
                        0xb9, 0x5f, 0xc3, 0x75, 0xae, 0xa7, 0x71, 0x6c, 0x21, 0xb6, 0x4f, 0xf0, 0x1f, 0xfa, 0xb8, 0xe2,
                        0xde, 0xd0, 0xbf, 0xa1, 0xd4, 0xa7, 0xd2, 0x8a, 0xd4, 0xbe, 0x9c, 0x75, 0xf3, 0xed, 0x5d, 0xcf,
                        0x1f, 0x72, 0x1a, 0xa5, 0xfd, 0x02, 0x41, 0xea, 0x39, 0x45, 0x17, 0x23, 0x2b, 0x35, 0x62, 0x4d,
                        0x71, 0x03, 0x06, 0x21, 0x8d, 0x0a, 0x1c, 0x73, 0x72, 0x75, 0x32, 0x9a, 0xe8, 0x6a, 0x2c, 0x63,
                        0x32, 0x28, 0x1b, 0x27, 0x0b, 0x52, 0x99, 0x56, 0x27, 0xc8, 0xd5, 0xb9, 0xd3, 0xbf, 0xc2, 0xd5,
                        0xe2, 0xbf, 0x5e, 0x80, 0x2f, 0xe6, 0x82, 0x99, 0xfd, 0xde, 0x7e, 0xae, 0x8a, 0x36, 0x55, 0xc1,
                        0x8a, 0x07, 0x85, 0xce, 0x84, 0x18, 0xfb, 0xa0, 0x47, 0xf8, 0x54, 0x21, 0x51, 0xea, 0xd6, 0x44,
                        0x66, 0x98, 0x86, 0x42, 0x2b, 0x88, 0xa7, 0x90, 0x6b, 0xd9, 0x2f, 0xd3, 0x9c, 0xa7, 0x21, 0x31,
                        0xb1, 0x8d, 0xca, 0x19, 0xe5, 0xed, 0x4b, 0xeb, 0x49, 0x12, 0x9b, 0x5a, 0x61, 0x69, 0xd3, 0xea,
                        0x67, 0x61, 0xc5, 0x69, 0x4e, 0x73, 0x89, 0x13, 0xb3, 0x45, 0x9d, 0xda, 0x85, 0x91, 0x3a, 0x4c,
                        0x36, 0x26, 0xc4, 0x45, 0x17, 0x55, 0x29, 0xba, 0x62, 0x2e, 0xa4, 0x06, 0x69, 0xda, 0x07, 0x2c,
                        0x35, 0xa2, 0x4c, 0xdf, 0xe2, 0x84, 0xde, 0x6e, 0xe2, 0x68, 0x6e, 0xaf, 0x90, 0x22, 0xcd, 0x55,
                        0x84, 0x02, 0xd1},
                DLUPD_OUTGOING, DLUS_NOTFOUND, ""},
};
INSTANTIATE_TEST_SUITE_P(DomainLookuperTLS, OutgoingDataTcp, testing::ValuesIn(TLS_TEST_SAMPLES));

class TLSExchange : public testing::Test {
public:
    DomainLookuper lookuper = {};
    DomainLookuperResult result = {};

    TLSExchange() {
        ag::Logger::set_log_level(ag::LOG_LEVEL_TRACE);
    }

    void SetUp() override {
        result = {};
        static const std::vector<uint8_t> CLIENT_HELLO_NOSNI = {0x16, 0x03, 0x01, 0x01, 0x2C, 0x01, 0x00, 0x01, 0x28,
                0x03, 0x03, 0x77, 0xB6, 0x93, 0xFB, 0xA0, 0xE5, 0x3F, 0xA2, 0x3E, 0x44, 0x04, 0x1B, 0x54, 0x18, 0x44,
                0x1B, 0x1D, 0x16, 0x27, 0x6B, 0x73, 0x2B, 0xBE, 0xDC, 0x38, 0xA2, 0x88, 0xAB, 0x9E, 0x4D, 0xC2, 0x7E,
                0x00, 0x00, 0xAA, 0xC0, 0x30, 0xC0, 0x2C, 0xC0, 0x28, 0xC0, 0x24, 0xC0, 0x14, 0xC0, 0x0A, 0x00, 0xA5,
                0x00, 0xA3, 0x00, 0xA1, 0x00, 0x9F, 0x00, 0x6B, 0x00, 0x6A, 0x00, 0x69, 0x00, 0x68, 0x00, 0x39, 0x00,
                0x38, 0x00, 0x37, 0x00, 0x36, 0x00, 0x88, 0x00, 0x87, 0x00, 0x86, 0x00, 0x85, 0xC0, 0x32, 0xC0, 0x2E,
                0xC0, 0x2A, 0xC0, 0x26, 0xC0, 0x0F, 0xC0, 0x05, 0x00, 0x9D, 0x00, 0x3D, 0x00, 0x35, 0x00, 0x84, 0xC0,
                0x2F, 0xC0, 0x2B, 0xC0, 0x27, 0xC0, 0x23, 0xC0, 0x13, 0xC0, 0x09, 0x00, 0xA4, 0x00, 0xA2, 0x00, 0xA0,
                0x00, 0x9E, 0x00, 0x67, 0x00, 0x40, 0x00, 0x3F, 0x00, 0x3E, 0x00, 0x33, 0x00, 0x32, 0x00, 0x31, 0x00,
                0x30, 0x00, 0x9A, 0x00, 0x99, 0x00, 0x98, 0x00, 0x97, 0x00, 0x45, 0x00, 0x44, 0x00, 0x43, 0x00, 0x42,
                0xC0, 0x31, 0xC0, 0x2D, 0xC0, 0x29, 0xC0, 0x25, 0xC0, 0x0E, 0xC0, 0x04, 0x00, 0x9C, 0x00, 0x3C, 0x00,
                0x2F, 0x00, 0x96, 0x00, 0x41, 0xC0, 0x11, 0xC0, 0x07, 0xC0, 0x0C, 0xC0, 0x02, 0x00, 0x05, 0x00, 0x04,
                0xC0, 0x12, 0xC0, 0x08, 0x00, 0x16, 0x00, 0x13, 0x00, 0x10, 0x00, 0x0D, 0xC0, 0x0D, 0xC0, 0x03, 0x00,
                0x0A, 0x00, 0xFF, 0x01, 0x00, 0x00, 0x55, 0x00, 0x0B, 0x00, 0x04, 0x03, 0x00, 0x01, 0x02, 0x00, 0x0A,
                0x00, 0x1C, 0x00, 0x1A, 0x00, 0x17, 0x00, 0x19, 0x00, 0x1C, 0x00, 0x1B, 0x00, 0x18, 0x00, 0x1A, 0x00,
                0x16, 0x00, 0x0E, 0x00, 0x0D, 0x00, 0x0B, 0x00, 0x0C, 0x00, 0x09, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x00,
                0x00, 0x0D, 0x00, 0x20, 0x00, 0x1E, 0x06, 0x01, 0x06, 0x02, 0x06, 0x03, 0x05, 0x01, 0x05, 0x02, 0x05,
                0x03, 0x04, 0x01, 0x04, 0x02, 0x04, 0x03, 0x03, 0x01, 0x03, 0x02, 0x03, 0x03, 0x02, 0x01, 0x02, 0x02,
                0x02, 0x03, 0x00, 0x0F, 0x00, 0x01, 0x01};
        result = lookuper.proceed(DLUPD_OUTGOING, IPPROTO_TCP, CLIENT_HELLO_NOSNI.data(), CLIENT_HELLO_NOSNI.size());
        ASSERT_EQ(result.status, DLUS_PASS);
    }
};

TEST_F(TLSExchange, Test) {
    static const std::vector<uint8_t> SERVER_HELLO = {0x16, 0x03, 0x03, 0x00, 0x42, 0x02, 0x00, 0x00, 0x3e, 0x03, 0x03,
            0xf9, 0xcb, 0x24, 0xe7, 0x0b, 0x82, 0x43, 0x12, 0x1f, 0x6a, 0xc5, 0xfd, 0x36, 0x5f, 0x95, 0xf4, 0x8b, 0x16,
            0xde, 0x1f, 0xbd, 0xbb, 0xff, 0x56, 0x00, 0x7c, 0x3d, 0xc5, 0xef, 0x28, 0xae, 0x06, 0x00, 0xc0, 0x2f, 0x00,
            0x00, 0x16, 0xff, 0x01, 0x00, 0x01, 0x00, 0x00, 0x0b, 0x00, 0x04, 0x03, 0x00, 0x01, 0x02, 0x00, 0x23, 0x00,
            0x00, 0x00, 0x0f, 0x00, 0x01, 0x01};

    result = lookuper.proceed(DLUPD_INCOMING, IPPROTO_TCP, SERVER_HELLO.data(), SERVER_HELLO.size());
    ASSERT_EQ(result.status, DLUS_PASS);

    static const std::vector<uint8_t> SERVER_CERT = {0x16, 0x03, 0x03, 0x0f, 0x84, 0x0b, 0x00, 0x0f, 0x80, 0x00, 0x0f,
            0x7d, 0x00, 0x06, 0x10, 0x30, 0x82, 0x06, 0x0c, 0x30, 0x82, 0x04, 0xf4, 0xa0, 0x03, 0x02, 0x01, 0x02, 0x02,
            0x10, 0x30, 0x60, 0x21, 0xa9, 0xc0, 0xcc, 0x76, 0x97, 0x87, 0x1d, 0xe5, 0xa8, 0x4d, 0x8e, 0xf9, 0x97, 0x30,
            0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x0b, 0x05, 0x00, 0x30, 0x5f, 0x31, 0x0b,
            0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x52, 0x55, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55,
            0x04, 0x0a, 0x13, 0x0a, 0x59, 0x61, 0x6e, 0x64, 0x65, 0x78, 0x20, 0x4c, 0x4c, 0x43, 0x31, 0x27, 0x30, 0x25,
            0x06, 0x03, 0x55, 0x04, 0x0b, 0x13, 0x1e, 0x59, 0x61, 0x6e, 0x64, 0x65, 0x78, 0x20, 0x43, 0x65, 0x72, 0x74,
            0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x20, 0x41, 0x75, 0x74, 0x68, 0x6f, 0x72, 0x69, 0x74,
            0x79, 0x31, 0x12, 0x30, 0x10, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x09, 0x59, 0x61, 0x6e, 0x64, 0x65, 0x78,
            0x20, 0x43, 0x41, 0x30, 0x1e, 0x17, 0x0d, 0x31, 0x37, 0x30, 0x36, 0x32, 0x31, 0x31, 0x37, 0x31, 0x38, 0x32,
            0x33, 0x5a, 0x17, 0x0d, 0x31, 0x39, 0x30, 0x36, 0x32, 0x31, 0x31, 0x37, 0x31, 0x38, 0x32, 0x33, 0x5a, 0x30,
            0x6e, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x52, 0x55, 0x31, 0x13, 0x30, 0x11,
            0x06, 0x03, 0x55, 0x04, 0x0a, 0x0c, 0x0a, 0x59, 0x61, 0x6e, 0x64, 0x65, 0x78, 0x20, 0x4c, 0x4c, 0x43, 0x31,
            0x0c, 0x30, 0x0a, 0x06, 0x03, 0x55, 0x04, 0x0b, 0x0c, 0x03, 0x49, 0x54, 0x4f, 0x31, 0x0f, 0x30, 0x0d, 0x06,
            0x03, 0x55, 0x04, 0x07, 0x0c, 0x06, 0x4d, 0x6f, 0x73, 0x63, 0x6f, 0x77, 0x31, 0x1b, 0x30, 0x19, 0x06, 0x03,
            0x55, 0x04, 0x08, 0x0c, 0x12, 0x52, 0x75, 0x73, 0x73, 0x69, 0x61, 0x6e, 0x20, 0x46, 0x65, 0x64, 0x65, 0x72,
            0x61, 0x74, 0x69, 0x6f, 0x6e, 0x31, 0x0e, 0x30, 0x0c, 0x06, 0x03, 0x55, 0x04, 0x03, 0x0c, 0x05, 0x79, 0x61,
            0x2e, 0x72, 0x75, 0x30, 0x82, 0x01, 0x22, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01,
            0x01, 0x01, 0x05, 0x00, 0x03, 0x82, 0x01, 0x0f, 0x00, 0x30, 0x82, 0x01, 0x0a, 0x02, 0x82, 0x01, 0x01, 0x00,
            0xe5, 0x72, 0xfe, 0x46, 0x49, 0x06, 0x78, 0x78, 0x99, 0x36, 0x62, 0x9b, 0xe3, 0xfb, 0xf3, 0xe2, 0x08, 0xdc,
            0xca, 0x1e, 0x89, 0xd2, 0x34, 0x27, 0x66, 0x0d, 0x20, 0x8a, 0x57, 0xc5, 0xee, 0xe0, 0x25, 0xda, 0x6b, 0x11,
            0xfb, 0x9f, 0x24, 0xd9, 0x6d, 0xcc, 0xe7, 0x5e, 0xbe, 0x11, 0x67, 0x67, 0xa8, 0xe3, 0xe7, 0x39, 0xe7, 0x3c,
            0x39, 0xc2, 0xa7, 0xcb, 0xba, 0x5f, 0xc8, 0x90, 0x61, 0x61, 0x04, 0xa7, 0x7b, 0xdf, 0xcd, 0x03, 0xce, 0x42,
            0x37, 0x7c, 0x07, 0xbd, 0x0d, 0x91, 0x16, 0x27, 0x5e, 0xec, 0x52, 0xdc, 0xb1, 0x4e, 0x65, 0x9b, 0xcb, 0xd5,
            0xb0, 0xf0, 0xcf, 0x4e, 0x62, 0xbe, 0xf3, 0x5a, 0x05, 0x3f, 0xa0, 0x83, 0x7e, 0xe5, 0x2e, 0xeb, 0x5e, 0xd8,
            0x3f, 0x37, 0x74, 0x2c, 0x4a, 0x31, 0xc6, 0x9d, 0xdf, 0xe3, 0x8c, 0x55, 0x3f, 0x18, 0x49, 0x26, 0x52, 0x99,
            0x53, 0x0e, 0x1c, 0xcf, 0xa2, 0x5d, 0x9b, 0x5c, 0x23, 0x74, 0xd4, 0x89, 0x0d, 0x1e, 0xdc, 0x3e, 0x3f, 0xe7,
            0xab, 0x4d, 0xd7, 0x22, 0xa8, 0x8e, 0xb1, 0x25, 0x27, 0xb1, 0x56, 0x83, 0xf2, 0x29, 0xbb, 0x46, 0xd1, 0x66,
            0x54, 0x37, 0xbb, 0xf2, 0xf3, 0x80, 0x4f, 0xf9, 0xde, 0xc5, 0x46, 0xec, 0xce, 0x69, 0x7e, 0xa9, 0x50, 0x8d,
            0xe8, 0x0e, 0x31, 0xad, 0x5c, 0x48, 0xc5, 0xe1, 0xc7, 0x81, 0x1d, 0x6b, 0x2d, 0xfd, 0x92, 0xaa, 0x1f, 0x80,
            0xe4, 0xf6, 0xcf, 0xdf, 0xce, 0x3e, 0x79, 0x26, 0x82, 0xe4, 0x92, 0x99, 0x74, 0x88, 0x70, 0xe8, 0xe5, 0x7b,
            0xc7, 0x44, 0xf7, 0xe0, 0xaa, 0x7a, 0x77, 0x60, 0xd0, 0x53, 0x8f, 0x09, 0x9a, 0x8b, 0xb4, 0x1c, 0xb8, 0xcf,
            0x80, 0x0b, 0x32, 0x6e, 0xdf, 0xa4, 0x6b, 0x2e, 0x0c, 0x94, 0x57, 0x90, 0x7d, 0x23, 0x32, 0x19, 0x32, 0x3e,
            0x99, 0xf5, 0x30, 0xb3, 0x02, 0x03, 0x01, 0x00, 0x01, 0xa3, 0x82, 0x02, 0xb3, 0x30, 0x82, 0x02, 0xaf, 0x30,
            0x0c, 0x06, 0x03, 0x55, 0x1d, 0x13, 0x01, 0x01, 0xff, 0x04, 0x02, 0x30, 0x00, 0x30, 0x69, 0x06, 0x03, 0x55,
            0x1d, 0x1f, 0x04, 0x62, 0x30, 0x60, 0x30, 0x2f, 0xa0, 0x2d, 0xa0, 0x2b, 0x86, 0x29, 0x68, 0x74, 0x74, 0x70,
            0x3a, 0x2f, 0x2f, 0x63, 0x72, 0x6c, 0x73, 0x2e, 0x79, 0x61, 0x6e, 0x64, 0x65, 0x78, 0x2e, 0x6e, 0x65, 0x74,
            0x2f, 0x63, 0x65, 0x72, 0x74, 0x75, 0x6d, 0x2f, 0x79, 0x63, 0x61, 0x73, 0x68, 0x61, 0x32, 0x2e, 0x63, 0x72,
            0x6c, 0x30, 0x2d, 0xa0, 0x2b, 0xa0, 0x29, 0x86, 0x27, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x79, 0x61,
            0x6e, 0x64, 0x65, 0x78, 0x2e, 0x63, 0x72, 0x6c, 0x2e, 0x63, 0x65, 0x72, 0x74, 0x75, 0x6d, 0x2e, 0x70, 0x6c,
            0x2f, 0x79, 0x63, 0x61, 0x73, 0x68, 0x61, 0x32, 0x2e, 0x63, 0x72, 0x6c, 0x30, 0x71, 0x06, 0x08, 0x2b, 0x06,
            0x01, 0x05, 0x05, 0x07, 0x01, 0x01, 0x04, 0x65, 0x30, 0x63, 0x30, 0x2c, 0x06, 0x08, 0x2b, 0x06, 0x01, 0x05,
            0x05, 0x07, 0x30, 0x01, 0x86, 0x20, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x79, 0x61, 0x6e, 0x64, 0x65,
            0x78, 0x2e, 0x6f, 0x63, 0x73, 0x70, 0x2d, 0x72, 0x65, 0x73, 0x70, 0x6f, 0x6e, 0x64, 0x65, 0x72, 0x2e, 0x63,
            0x6f, 0x6d, 0x30, 0x33, 0x06, 0x08, 0x2b, 0x06, 0x01, 0x05, 0x05, 0x07, 0x30, 0x02, 0x86, 0x27, 0x68, 0x74,
            0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x72, 0x65, 0x70, 0x6f, 0x73, 0x69, 0x74, 0x6f, 0x72, 0x79, 0x2e, 0x63, 0x65,
            0x72, 0x74, 0x75, 0x6d, 0x2e, 0x70, 0x6c, 0x2f, 0x79, 0x63, 0x61, 0x73, 0x68, 0x61, 0x32, 0x2e, 0x63, 0x65,
            0x72, 0x30, 0x1f, 0x06, 0x03, 0x55, 0x1d, 0x23, 0x04, 0x18, 0x30, 0x16, 0x80, 0x14, 0x37, 0x5c, 0xe3, 0x19,
            0xe0, 0xb2, 0x8e, 0xa1, 0xa8, 0x4e, 0xd2, 0xcf, 0xab, 0xd0, 0xdc, 0xe3, 0x0b, 0x5c, 0x35, 0x4d, 0x30, 0x1d,
            0x06, 0x03, 0x55, 0x1d, 0x0e, 0x04, 0x16, 0x04, 0x14, 0xb8, 0xd8, 0x0f, 0x12, 0xe2, 0xb8, 0xee, 0x01, 0x9b,
            0xa1, 0x8d, 0xa9, 0x51, 0x16, 0xdb, 0x29, 0xd5, 0x93, 0x83, 0xcc, 0x30, 0x0e, 0x06, 0x03, 0x55, 0x1d, 0x0f,
            0x01, 0x01, 0xff, 0x04, 0x04, 0x03, 0x02, 0x05, 0xa0, 0x30, 0x82, 0x01, 0x17, 0x06, 0x03, 0x55, 0x1d, 0x20,
            0x04, 0x82, 0x01, 0x0e, 0x30, 0x82, 0x01, 0x0a, 0x30, 0x82, 0x01, 0x06, 0x06, 0x0c, 0x2a, 0x84, 0x68, 0x01,
            0x86, 0xf6, 0x77, 0x02, 0x05, 0x01, 0x0a, 0x02, 0x30, 0x81, 0xf5, 0x30, 0x81, 0xf2, 0x06, 0x08, 0x2b, 0x06,
            0x01, 0x05, 0x05, 0x07, 0x02, 0x02, 0x30, 0x81, 0xe5, 0x30, 0x20, 0x16, 0x19, 0x55, 0x6e, 0x69, 0x7a, 0x65,
            0x74, 0x6f, 0x20, 0x54, 0x65, 0x63, 0x68, 0x6e, 0x6f, 0x6c, 0x6f, 0x67, 0x69, 0x65, 0x73, 0x20, 0x53, 0x2e,
            0x41, 0x2e, 0x30, 0x03, 0x02, 0x01, 0x02, 0x1a, 0x81, 0xc0, 0x55, 0x73, 0x61, 0x67, 0x65, 0x20, 0x6f, 0x66,
            0x20, 0x74, 0x68, 0x69, 0x73, 0x20, 0x63, 0x65, 0x72, 0x74, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x65, 0x20,
            0x69, 0x73, 0x20, 0x73, 0x74, 0x72, 0x69, 0x63, 0x74, 0x6c, 0x79, 0x20, 0x73, 0x75, 0x62, 0x6a, 0x65, 0x63,
            0x74, 0x65, 0x64, 0x20, 0x74, 0x6f, 0x20, 0x74, 0x68, 0x65, 0x20, 0x43, 0x45, 0x52, 0x54, 0x55, 0x4d, 0x20,
            0x43, 0x65, 0x72, 0x74, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x20, 0x50, 0x72, 0x61, 0x63,
            0x74, 0x69, 0x63, 0x65, 0x20, 0x53, 0x74, 0x61, 0x74, 0x65, 0x6d, 0x65, 0x6e, 0x74, 0x20, 0x28, 0x43, 0x50,
            0x53, 0x29, 0x20, 0x69, 0x6e, 0x63, 0x6f, 0x72, 0x70, 0x6f, 0x72, 0x61, 0x74, 0x65, 0x64, 0x20, 0x62, 0x79,
            0x20, 0x72, 0x65, 0x66, 0x65, 0x72, 0x65, 0x6e, 0x63, 0x65, 0x20, 0x68, 0x65, 0x72, 0x65, 0x69, 0x6e, 0x20,
            0x61, 0x6e, 0x64, 0x20, 0x69, 0x6e, 0x20, 0x74, 0x68, 0x65, 0x20, 0x72, 0x65, 0x70, 0x6f, 0x73, 0x69, 0x74,
            0x6f, 0x72, 0x79, 0x20, 0x61, 0x74, 0x20, 0x68, 0x74, 0x74, 0x70, 0x73, 0x3a, 0x2f, 0x2f, 0x77, 0x77, 0x77,
            0x2e, 0x63, 0x65, 0x72, 0x74, 0x75, 0x6d, 0x2e, 0x70, 0x6c, 0x2f, 0x72, 0x65, 0x70, 0x6f, 0x73, 0x69, 0x74,
            0x6f, 0x72, 0x79, 0x2e, 0x30, 0x1d, 0x06, 0x03, 0x55, 0x1d, 0x25, 0x04, 0x16, 0x30, 0x14, 0x06, 0x08, 0x2b,
            0x06, 0x01, 0x05, 0x05, 0x07, 0x03, 0x01, 0x06, 0x08, 0x2b, 0x06, 0x01, 0x05, 0x05, 0x07, 0x03, 0x02, 0x30,
            0x11, 0x06, 0x09, 0x60, 0x86, 0x48, 0x01, 0x86, 0xf8, 0x42, 0x01, 0x01, 0x04, 0x04, 0x03, 0x02, 0x06, 0xc0,
            0x30, 0x24, 0x06, 0x03, 0x55, 0x1d, 0x11, 0x04, 0x1d, 0x30, 0x1b, 0x82, 0x05, 0x79, 0x61, 0x2e, 0x72, 0x75,
            0x82, 0x09, 0x77, 0x77, 0x77, 0x2e, 0x79, 0x61, 0x2e, 0x72, 0x75, 0x82, 0x07, 0x6d, 0x2e, 0x79, 0x61, 0x2e,
            0x72, 0x75, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x0b, 0x05, 0x00, 0x03,
            0x82, 0x01, 0x01, 0x00, 0x07, 0x1c, 0x40, 0xfc, 0x15, 0xb0, 0x96, 0xf6, 0xad, 0xd7, 0x9b, 0x0f, 0x22, 0x92,
            0x79, 0xbf, 0x25, 0x29, 0x74, 0x38, 0x24, 0x8a, 0x07, 0x4b, 0xe5, 0x70, 0xc8, 0xc2, 0xfd, 0x86, 0xdc, 0xfd,
            0x47, 0x46, 0xf8, 0x8d, 0x15, 0xe1, 0x63, 0xef, 0x38, 0xaa, 0x00, 0xaf, 0x25, 0x34, 0x80, 0xc1, 0x61, 0x1a,
            0x0d, 0x53, 0x5d, 0xb6, 0x98, 0xef, 0x4e, 0x5b, 0xfe, 0x89, 0x6b, 0x3f, 0x89, 0x60, 0x41, 0x54, 0x11, 0xe5,
            0x9f, 0x0a, 0x7e, 0xe0, 0x72, 0x05, 0x19, 0xc0, 0x08, 0xc9, 0x1f, 0xb6, 0x30, 0xe2, 0xf4, 0xf1, 0xdc, 0x65,
            0x2c, 0x9b, 0xe0, 0x19, 0x06, 0x39, 0x91, 0x94, 0xb0, 0x12, 0x22, 0x67, 0x72, 0x80, 0x84, 0x4f, 0x4d, 0x92,
            0x93, 0x49, 0xb9, 0x7a, 0x06, 0xe7, 0x18, 0xc7, 0x02, 0xc7, 0x3a, 0x7a, 0xdb, 0x8e, 0x54, 0xd2, 0x94, 0xbf,
            0xf1, 0xc6, 0xf8, 0x3d, 0x81, 0x44, 0xb4, 0x88, 0xb9, 0x4f, 0xd5, 0x34, 0xb5, 0x8b, 0x81, 0x36, 0x5f, 0x6c,
            0xd2, 0xa7, 0xe1, 0xa6, 0x1e, 0xb9, 0x11, 0xac, 0x8f, 0x29, 0x60, 0xf9, 0xb0, 0xa0, 0x76, 0xe6, 0xae, 0x9f,
            0x49, 0x3c, 0x1f, 0xc1, 0x21, 0x89, 0x09, 0x91, 0x70, 0x5b, 0x43, 0xa7, 0xf9, 0x87, 0xac, 0xc1, 0x64, 0x97,
            0x9c, 0x79, 0x11, 0xca, 0xe6, 0xa3, 0xcf, 0x8d, 0x66, 0x40, 0x72, 0x46, 0x52, 0x24, 0x08, 0x14, 0xea, 0x7d,
            0x73, 0x1f, 0x69, 0x31, 0x10, 0xf3, 0x2a, 0x5d, 0xf6, 0xd6, 0x9a, 0x6c, 0x85, 0x5c, 0x6d, 0x02, 0xe5, 0xaf,
            0xc2, 0x3d, 0x12, 0xb3, 0x94, 0x01, 0x22, 0x79, 0x15, 0xed, 0x36, 0x16, 0x61, 0xc2, 0xea, 0xd5, 0x37, 0x50,
            0x0d, 0x61, 0xa8, 0x49, 0xd6, 0xe1, 0x5c, 0x89, 0x5d, 0x33, 0x23, 0x3f, 0xaf, 0xf8, 0xc1, 0x6e, 0xfc, 0xbd,
            0xd8, 0x5f, 0x97, 0xba, 0xe6, 0x7d, 0xd6, 0xa3, 0x00, 0x04, 0xac, 0x30, 0x82, 0x04, 0xa8, 0x30, 0x82, 0x03,
            0x90, 0xa0, 0x03, 0x02, 0x01, 0x02, 0x02, 0x11, 0x00, 0xe4, 0x05, 0x47, 0x83, 0x0e, 0x0c, 0x64, 0x52, 0x97,
            0x6f, 0x7a, 0x35, 0x49, 0xc0, 0xdd, 0x48, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01,
            0x01, 0x0b, 0x05, 0x00, 0x30, 0x7e, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x50,
            0x4c, 0x31, 0x22, 0x30, 0x20, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13, 0x19, 0x55, 0x6e, 0x69, 0x7a, 0x65, 0x74,
            0x6f, 0x20, 0x54, 0x65, 0x63, 0x68, 0x6e, 0x6f, 0x6c, 0x6f, 0x67, 0x69, 0x65, 0x73, 0x20, 0x53, 0x2e, 0x41,
            0x2e, 0x31, 0x27, 0x30, 0x25, 0x06, 0x03, 0x55, 0x04, 0x0b, 0x13, 0x1e, 0x43, 0x65, 0x72, 0x74, 0x75, 0x6d,
            0x20, 0x43, 0x65, 0x72, 0x74, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x20, 0x41, 0x75, 0x74,
            0x68, 0x6f, 0x72, 0x69, 0x74, 0x79, 0x31, 0x22, 0x30, 0x20, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x19, 0x43,
            0x65, 0x72, 0x74, 0x75, 0x6d, 0x20, 0x54, 0x72, 0x75, 0x73, 0x74, 0x65, 0x64, 0x20, 0x4e, 0x65, 0x74, 0x77,
            0x6f, 0x72, 0x6b, 0x20, 0x43, 0x41, 0x30, 0x1e, 0x17, 0x0d, 0x31, 0x35, 0x30, 0x31, 0x32, 0x31, 0x31, 0x32,
            0x30, 0x30, 0x30, 0x30, 0x5a, 0x17, 0x0d, 0x32, 0x35, 0x30, 0x31, 0x31, 0x38, 0x31, 0x32, 0x30, 0x30, 0x30,
            0x30, 0x5a, 0x30, 0x5f, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x52, 0x55, 0x31,
            0x13, 0x30, 0x11, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13, 0x0a, 0x59, 0x61, 0x6e, 0x64, 0x65, 0x78, 0x20, 0x4c,
            0x4c, 0x43, 0x31, 0x27, 0x30, 0x25, 0x06, 0x03, 0x55, 0x04, 0x0b, 0x13, 0x1e, 0x59, 0x61, 0x6e, 0x64, 0x65,
            0x78, 0x20, 0x43, 0x65, 0x72, 0x74, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x20, 0x41, 0x75,
            0x74, 0x68, 0x6f, 0x72, 0x69, 0x74, 0x79, 0x31, 0x12, 0x30, 0x10, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x09,
            0x59, 0x61, 0x6e, 0x64, 0x65, 0x78, 0x20, 0x43, 0x41, 0x30, 0x82, 0x01, 0x22, 0x30, 0x0d, 0x06, 0x09, 0x2a,
            0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x82, 0x01, 0x0f, 0x00, 0x30, 0x82, 0x01,
            0x0a, 0x02, 0x82, 0x01, 0x01, 0x00, 0xa6, 0x05, 0x24, 0x76, 0x61, 0xb9, 0x9e, 0x42, 0x60, 0x22, 0x63, 0x85,
            0x59, 0xe5, 0x9d, 0x88, 0x0d, 0xdf, 0xef, 0x21, 0x64, 0x5a, 0x26, 0x94, 0x71, 0x3a, 0xa4, 0x7f, 0x2b, 0x53,
            0xc3, 0xac, 0x7b, 0xba, 0x95, 0x42, 0x6d, 0x6a, 0x5b, 0xd6, 0x7e, 0x78, 0x0c, 0x67, 0x40, 0x98, 0x2f, 0x6a,
            0x2d, 0xd0, 0xb7, 0x18, 0x3a, 0x7e, 0x99, 0x60, 0x01, 0xe5, 0x27, 0xbf, 0xff, 0x49, 0xf5, 0xcd, 0xc4, 0x58,
            0xc3, 0x4c, 0xe1, 0x70, 0xd5, 0xfd, 0x08, 0xa8, 0x79, 0x95, 0x76, 0x1c, 0x0e, 0x05, 0x41, 0xfa, 0xbd, 0x80,
            0x38, 0x2a, 0x87, 0x4f, 0xc1, 0x67, 0x42, 0xaa, 0x17, 0xa6, 0xee, 0xa7, 0x8c, 0x8e, 0xef, 0x2d, 0x7f, 0x7a,
            0x1d, 0x05, 0x17, 0x8f, 0x7e, 0x3b, 0x92, 0x35, 0xf5, 0x68, 0xed, 0x93, 0x03, 0x55, 0x23, 0x4f, 0x4b, 0xa2,
            0x00, 0x86, 0x65, 0x91, 0x0f, 0xeb, 0xf6, 0x3c, 0xd5, 0xdb, 0x6d, 0x0e, 0xed, 0xe8, 0x7c, 0x3a, 0xc8, 0xba,
            0xb7, 0x53, 0xc1, 0xa4, 0xd8, 0x40, 0x02, 0xe5, 0xb5, 0xa2, 0xca, 0xbf, 0xda, 0x9c, 0x94, 0x0d, 0xfc, 0xc5,
            0x1c, 0x2a, 0x59, 0x88, 0x62, 0x57, 0x93, 0x2e, 0x11, 0xf0, 0x38, 0x2c, 0x7a, 0x81, 0x2a, 0xf2, 0x25, 0x15,
            0x17, 0x35, 0x70, 0x2c, 0x4b, 0xf7, 0x23, 0x4c, 0x82, 0xef, 0x33, 0x9f, 0xc2, 0x9a, 0x0b, 0xa3, 0xe2, 0x5d,
            0x6b, 0x38, 0x77, 0xf9, 0x60, 0x33, 0xcf, 0x2e, 0x7b, 0x56, 0xb7, 0x13, 0x93, 0x1f, 0x34, 0x97, 0x71, 0x99,
            0x76, 0x02, 0x46, 0x35, 0x14, 0x7c, 0xdc, 0xca, 0x48, 0x8a, 0x0a, 0x72, 0x4b, 0x78, 0x6d, 0x82, 0x34, 0x96,
            0x13, 0x45, 0xcf, 0x02, 0x2f, 0x50, 0x13, 0x39, 0x43, 0x89, 0xc0, 0xe1, 0x74, 0xd7, 0x28, 0x71, 0x21, 0xe5,
            0xaa, 0x97, 0x0e, 0xee, 0x46, 0xec, 0x93, 0xf7, 0x23, 0x7d, 0x02, 0x03, 0x01, 0x00, 0x01, 0xa3, 0x82, 0x01,
            0x3e, 0x30, 0x82, 0x01, 0x3a, 0x30, 0x0f, 0x06, 0x03, 0x55, 0x1d, 0x13, 0x01, 0x01, 0xff, 0x04, 0x05, 0x30,
            0x03, 0x01, 0x01, 0xff, 0x30, 0x1d, 0x06, 0x03, 0x55, 0x1d, 0x0e, 0x04, 0x16, 0x04, 0x14, 0x37, 0x5c, 0xe3,
            0x19, 0xe0, 0xb2, 0x8e, 0xa1, 0xa8, 0x4e, 0xd2, 0xcf, 0xab, 0xd0, 0xdc, 0xe3, 0x0b, 0x5c, 0x35, 0x4d, 0x30,
            0x1f, 0x06, 0x03, 0x55, 0x1d, 0x23, 0x04, 0x18, 0x30, 0x16, 0x80, 0x14, 0x08, 0x76, 0xcd, 0xcb, 0x07, 0xff,
            0x24, 0xf6, 0xc5, 0xcd, 0xed, 0xbb, 0x90, 0xbc, 0xe2, 0x84, 0x37, 0x46, 0x75, 0xf7, 0x30, 0x0e, 0x06, 0x03,
            0x55, 0x1d, 0x0f, 0x01, 0x01, 0xff, 0x04, 0x04, 0x03, 0x02, 0x01, 0x06, 0x30, 0x2f, 0x06, 0x03, 0x55, 0x1d,
            0x1f, 0x04, 0x28, 0x30, 0x26, 0x30, 0x24, 0xa0, 0x22, 0xa0, 0x20, 0x86, 0x1e, 0x68, 0x74, 0x74, 0x70, 0x3a,
            0x2f, 0x2f, 0x63, 0x72, 0x6c, 0x2e, 0x63, 0x65, 0x72, 0x74, 0x75, 0x6d, 0x2e, 0x70, 0x6c, 0x2f, 0x63, 0x74,
            0x6e, 0x63, 0x61, 0x2e, 0x63, 0x72, 0x6c, 0x30, 0x6b, 0x06, 0x08, 0x2b, 0x06, 0x01, 0x05, 0x05, 0x07, 0x01,
            0x01, 0x04, 0x5f, 0x30, 0x5d, 0x30, 0x28, 0x06, 0x08, 0x2b, 0x06, 0x01, 0x05, 0x05, 0x07, 0x30, 0x01, 0x86,
            0x1c, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x73, 0x75, 0x62, 0x63, 0x61, 0x2e, 0x6f, 0x63, 0x73, 0x70,
            0x2d, 0x63, 0x65, 0x72, 0x74, 0x75, 0x6d, 0x2e, 0x63, 0x6f, 0x6d, 0x30, 0x31, 0x06, 0x08, 0x2b, 0x06, 0x01,
            0x05, 0x05, 0x07, 0x30, 0x02, 0x86, 0x25, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x72, 0x65, 0x70, 0x6f,
            0x73, 0x69, 0x74, 0x6f, 0x72, 0x79, 0x2e, 0x63, 0x65, 0x72, 0x74, 0x75, 0x6d, 0x2e, 0x70, 0x6c, 0x2f, 0x63,
            0x74, 0x6e, 0x63, 0x61, 0x2e, 0x63, 0x65, 0x72, 0x30, 0x39, 0x06, 0x03, 0x55, 0x1d, 0x20, 0x04, 0x32, 0x30,
            0x30, 0x30, 0x2e, 0x06, 0x04, 0x55, 0x1d, 0x20, 0x00, 0x30, 0x26, 0x30, 0x24, 0x06, 0x08, 0x2b, 0x06, 0x01,
            0x05, 0x05, 0x07, 0x02, 0x01, 0x16, 0x18, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x77, 0x77, 0x77, 0x2e,
            0x63, 0x65, 0x72, 0x74, 0x75, 0x6d, 0x2e, 0x70, 0x6c, 0x2f, 0x43, 0x50, 0x53, 0x30, 0x0d, 0x06, 0x09, 0x2a,
            0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x0b, 0x05, 0x00, 0x03, 0x82, 0x01, 0x01, 0x00, 0x02, 0x5e, 0x8e,
            0x7b, 0xe0, 0x66, 0xa1, 0xc6, 0xab, 0x8b, 0x18, 0x1f, 0x0e, 0xb9, 0xc4, 0xcd, 0x71, 0xdb, 0x44, 0x5c, 0x03,
            0x7d, 0x65, 0xea, 0xb8, 0x47, 0xb5, 0x1e, 0xce, 0x24, 0x70, 0xa0, 0x7f, 0xd3, 0xdf, 0x66, 0x4b, 0x8c, 0x90,
            0xe2, 0xa5, 0xed, 0x9b, 0x94, 0x36, 0xb4, 0xa8, 0xbe, 0xf0, 0x74, 0x8c, 0x26, 0x92, 0x75, 0x9d, 0x56, 0x50,
            0x9e, 0xad, 0xd0, 0x1a, 0xa0, 0xdf, 0xa4, 0x14, 0x56, 0x10, 0x75, 0x93, 0x7a, 0xc1, 0xf4, 0x53, 0xa0, 0x76,
            0x74, 0x2c, 0x72, 0xba, 0xb5, 0xd1, 0xc9, 0xe2, 0xdc, 0x46, 0x86, 0x3f, 0x1d, 0xf6, 0x33, 0x87, 0x59, 0xec,
            0x9c, 0xdc, 0x2d, 0x1e, 0x4d, 0x43, 0x1a, 0xce, 0xba, 0xd9, 0x87, 0x7e, 0xe2, 0x47, 0x45, 0x72, 0x3d, 0x28,
            0x03, 0xc9, 0x0a, 0x4d, 0xe0, 0x57, 0xa3, 0x5e, 0x6e, 0x7e, 0xcc, 0x5a, 0xc8, 0xc4, 0x78, 0x01, 0x57, 0x68,
            0x7a, 0x38, 0x3b, 0x53, 0x36, 0xe7, 0x92, 0x6d, 0x8a, 0x2c, 0x2f, 0xd7, 0x8b, 0xb6, 0x34, 0xa8, 0xd1, 0xb6,
            0xf8, 0x5e, 0x3b, 0xab, 0xed, 0xa5, 0x8f, 0x39, 0x6f, 0x45, 0xad, 0xcb, 0x63, 0xed, 0x6a, 0x64, 0xc9, 0x10,
            0xa7, 0x03, 0x08, 0x12, 0x53, 0xb1, 0x1c, 0xaf, 0xca, 0xf7, 0x53, 0xfc, 0xd8, 0x29, 0x4b, 0x1b, 0xfb, 0x38,
            0xcd, 0xc0, 0x63, 0xff, 0x5f, 0xe4, 0xb9, 0x8d, 0x5e, 0xaa, 0x2b, 0xd2, 0xc3, 0x22, 0x35, 0x31, 0xf6, 0x30,
            0x0e, 0x53, 0x32, 0xf4, 0x93, 0xc5, 0x43, 0xcb, 0xc8, 0xf0, 0x15, 0x56, 0x8f, 0x00, 0x19, 0x87, 0xca, 0x78,
            0x22, 0x8d, 0xa0, 0x2e, 0xdb, 0x2f, 0xa0, 0xc3, 0x7e, 0x29, 0x5d, 0x91, 0x25, 0x84, 0x1d, 0x1d, 0x39, 0xab,
            0x1b, 0xc5, 0xd6, 0x91, 0xfe, 0x69, 0x0e, 0x46, 0x80, 0xbc, 0x45, 0x7b, 0x35, 0x53, 0x2a, 0xdf, 0x00, 0xb6,
            0x77, 0x00, 0x04, 0xb8, 0x30, 0x82, 0x04, 0xb4, 0x30, 0x82, 0x03, 0x9c, 0xa0, 0x03, 0x02, 0x01, 0x02, 0x02,
            0x11, 0x00, 0x93, 0x92, 0x85, 0x40, 0x01, 0x65, 0x71, 0x5f, 0x94, 0x7f, 0x28, 0x8f, 0xef, 0xc9, 0x9b, 0x28,
            0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x0b, 0x05, 0x00, 0x30, 0x3e, 0x31,
            0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x50, 0x4c, 0x31, 0x1b, 0x30, 0x19, 0x06, 0x03,
            0x55, 0x04, 0x0a, 0x13, 0x12, 0x55, 0x6e, 0x69, 0x7a, 0x65, 0x74, 0x6f, 0x20, 0x53, 0x70, 0x2e, 0x20, 0x7a,
            0x20, 0x6f, 0x2e, 0x6f, 0x2e, 0x31, 0x12, 0x30, 0x10, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x09, 0x43, 0x65,
            0x72, 0x74, 0x75, 0x6d, 0x20, 0x43, 0x41, 0x30, 0x1e, 0x17, 0x0d, 0x30, 0x38, 0x31, 0x30, 0x32, 0x32, 0x31,
            0x32, 0x30, 0x37, 0x33, 0x37, 0x5a, 0x17, 0x0d, 0x32, 0x37, 0x30, 0x36, 0x31, 0x30, 0x31, 0x30, 0x34, 0x36,
            0x33, 0x39, 0x5a, 0x30, 0x7e, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x50, 0x4c,
            0x31, 0x22, 0x30, 0x20, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13, 0x19, 0x55, 0x6e, 0x69, 0x7a, 0x65, 0x74, 0x6f,
            0x20, 0x54, 0x65, 0x63, 0x68, 0x6e, 0x6f, 0x6c, 0x6f, 0x67, 0x69, 0x65, 0x73, 0x20, 0x53, 0x2e, 0x41, 0x2e,
            0x31, 0x27, 0x30, 0x25, 0x06, 0x03, 0x55, 0x04, 0x0b, 0x13, 0x1e, 0x43, 0x65, 0x72, 0x74, 0x75, 0x6d, 0x20,
            0x43, 0x65, 0x72, 0x74, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x20, 0x41, 0x75, 0x74, 0x68,
            0x6f, 0x72, 0x69, 0x74, 0x79, 0x31, 0x22, 0x30, 0x20, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x19, 0x43, 0x65,
            0x72, 0x74, 0x75, 0x6d, 0x20, 0x54, 0x72, 0x75, 0x73, 0x74, 0x65, 0x64, 0x20, 0x4e, 0x65, 0x74, 0x77, 0x6f,
            0x72, 0x6b, 0x20, 0x43, 0x41, 0x30, 0x82, 0x01, 0x22, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7,
            0x0d, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x82, 0x01, 0x0f, 0x00, 0x30, 0x82, 0x01, 0x0a, 0x02, 0x82, 0x01,
            0x01, 0x00, 0xe3, 0xfb, 0x7d, 0xa3, 0x72, 0xba, 0xc2, 0xf0, 0xc9, 0x14, 0x87, 0xf5, 0x6b, 0x01, 0x4e, 0xe1,
            0x6e, 0x40, 0x07, 0xba, 0x6d, 0x27, 0x5d, 0x7f, 0xf7, 0x5b, 0x2d, 0xb3, 0x5a, 0xc7, 0x51, 0x5f, 0xab, 0xa4,
            0x32, 0xa6, 0x61, 0x87, 0xb6, 0x6e, 0x0f, 0x86, 0xd2, 0x30, 0x02, 0x97, 0xf8, 0xd7, 0x69, 0x57, 0xa1, 0x18,
            0x39, 0x5d, 0x6a, 0x64, 0x79, 0xc6, 0x01, 0x59, 0xac, 0x3c, 0x31, 0x4a, 0x38, 0x7c, 0xd2, 0x04, 0xd2, 0x4b,
            0x28, 0xe8, 0x20, 0x5f, 0x3b, 0x07, 0xa2, 0xcc, 0x4d, 0x73, 0xdb, 0xf3, 0xae, 0x4f, 0xc7, 0x56, 0xd5, 0x5a,
            0xa7, 0x96, 0x89, 0xfa, 0xf3, 0xab, 0x68, 0xd4, 0x23, 0x86, 0x59, 0x27, 0xcf, 0x09, 0x27, 0xbc, 0xac, 0x6e,
            0x72, 0x83, 0x1c, 0x30, 0x72, 0xdf, 0xe0, 0xa2, 0xe9, 0xd2, 0xe1, 0x74, 0x75, 0x19, 0xbd, 0x2a, 0x9e, 0x7b,
            0x15, 0x54, 0x04, 0x1b, 0xd7, 0x43, 0x39, 0xad, 0x55, 0x28, 0xc5, 0xe2, 0x1a, 0xbb, 0xf4, 0xc0, 0xe4, 0xae,
            0x38, 0x49, 0x33, 0xcc, 0x76, 0x85, 0x9f, 0x39, 0x45, 0xd2, 0xa4, 0x9e, 0xf2, 0x12, 0x8c, 0x51, 0xf8, 0x7c,
            0xe4, 0x2d, 0x7f, 0xf5, 0xac, 0x5f, 0xeb, 0x16, 0x9f, 0xb1, 0x2d, 0xd1, 0xba, 0xcc, 0x91, 0x42, 0x77, 0x4c,
            0x25, 0xc9, 0x90, 0x38, 0x6f, 0xdb, 0xf0, 0xcc, 0xfb, 0x8e, 0x1e, 0x97, 0x59, 0x3e, 0xd5, 0x60, 0x4e, 0xe6,
            0x05, 0x28, 0xed, 0x49, 0x79, 0x13, 0x4b, 0xba, 0x48, 0xdb, 0x2f, 0xf9, 0x72, 0xd3, 0x39, 0xca, 0xfe, 0x1f,
            0xd8, 0x34, 0x72, 0xf5, 0xb4, 0x40, 0xcf, 0x31, 0x01, 0xc3, 0xec, 0xde, 0x11, 0x2d, 0x17, 0x5d, 0x1f, 0xb8,
            0x50, 0xd1, 0x5e, 0x19, 0xa7, 0x69, 0xde, 0x07, 0x33, 0x28, 0xca, 0x50, 0x95, 0xf9, 0xa7, 0x54, 0xcb, 0x54,
            0x86, 0x50, 0x45, 0xa9, 0xf9, 0x49, 0x02, 0x03, 0x01, 0x00, 0x01, 0xa3, 0x82, 0x01, 0x6b, 0x30, 0x82, 0x01,
            0x67, 0x30, 0x0f, 0x06, 0x03, 0x55, 0x1d, 0x13, 0x01, 0x01, 0xff, 0x04, 0x05, 0x30, 0x03, 0x01, 0x01, 0xff,
            0x30, 0x1d, 0x06, 0x03, 0x55, 0x1d, 0x0e, 0x04, 0x16, 0x04, 0x14, 0x08, 0x76, 0xcd, 0xcb, 0x07, 0xff, 0x24,
            0xf6, 0xc5, 0xcd, 0xed, 0xbb, 0x90, 0xbc, 0xe2, 0x84, 0x37, 0x46, 0x75, 0xf7, 0x30, 0x52, 0x06, 0x03, 0x55,
            0x1d, 0x23, 0x04, 0x4b, 0x30, 0x49, 0xa1, 0x42, 0xa4, 0x40, 0x30, 0x3e, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03,
            0x55, 0x04, 0x06, 0x13, 0x02, 0x50, 0x4c, 0x31, 0x1b, 0x30, 0x19, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13, 0x12,
            0x55, 0x6e, 0x69, 0x7a, 0x65, 0x74, 0x6f, 0x20, 0x53, 0x70, 0x2e, 0x20, 0x7a, 0x20, 0x6f, 0x2e, 0x6f, 0x2e,
            0x31, 0x12, 0x30, 0x10, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x09, 0x43, 0x65, 0x72, 0x74, 0x75, 0x6d, 0x20,
            0x43, 0x41, 0x82, 0x03, 0x01, 0x00, 0x20, 0x30, 0x0e, 0x06, 0x03, 0x55, 0x1d, 0x0f, 0x01, 0x01, 0xff, 0x04,
            0x04, 0x03, 0x02, 0x01, 0x06, 0x30, 0x2c, 0x06, 0x03, 0x55, 0x1d, 0x1f, 0x04, 0x25, 0x30, 0x23, 0x30, 0x21,
            0xa0, 0x1f, 0xa0, 0x1d, 0x86, 0x1b, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x63, 0x72, 0x6c, 0x2e, 0x63,
            0x65, 0x72, 0x74, 0x75, 0x6d, 0x2e, 0x70, 0x6c, 0x2f, 0x63, 0x61, 0x2e, 0x63, 0x72, 0x6c, 0x30, 0x68, 0x06,
            0x08, 0x2b, 0x06, 0x01, 0x05, 0x05, 0x07, 0x01, 0x01, 0x04, 0x5c, 0x30, 0x5a, 0x30, 0x28, 0x06, 0x08, 0x2b,
            0x06, 0x01, 0x05, 0x05, 0x07, 0x30, 0x01, 0x86, 0x1c, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x73, 0x75,
            0x62, 0x63, 0x61, 0x2e, 0x6f, 0x63, 0x73, 0x70, 0x2d, 0x63, 0x65, 0x72, 0x74, 0x75, 0x6d, 0x2e, 0x63, 0x6f,
            0x6d, 0x30, 0x2e, 0x06, 0x08, 0x2b, 0x06, 0x01, 0x05, 0x05, 0x07, 0x30, 0x02, 0x86, 0x22, 0x68, 0x74, 0x74,
            0x70, 0x3a, 0x2f, 0x2f, 0x72, 0x65, 0x70, 0x6f, 0x73, 0x69, 0x74, 0x6f, 0x72, 0x79, 0x2e, 0x63, 0x65, 0x72,
            0x74, 0x75, 0x6d, 0x2e, 0x70, 0x6c, 0x2f, 0x63, 0x61, 0x2e, 0x63, 0x65, 0x72, 0x30, 0x39, 0x06, 0x03, 0x55,
            0x1d, 0x20, 0x04, 0x32, 0x30, 0x30, 0x30, 0x2e, 0x06, 0x04, 0x55, 0x1d, 0x20, 0x00, 0x30, 0x26, 0x30, 0x24,
            0x06, 0x08, 0x2b, 0x06, 0x01, 0x05, 0x05, 0x07, 0x02, 0x01, 0x16, 0x18, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f,
            0x2f, 0x77, 0x77, 0x77, 0x2e, 0x63, 0x65, 0x72, 0x74, 0x75, 0x6d, 0x2e, 0x70, 0x6c, 0x2f, 0x43, 0x50, 0x53,
            0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x0b, 0x05, 0x00, 0x03, 0x82, 0x01,
            0x01, 0x00, 0x8d, 0xe6, 0xfd, 0x40, 0x66, 0xa3, 0x4c, 0x9c, 0xa7, 0xab, 0xa1, 0xda, 0x84, 0xdd, 0x1c, 0x30,
            0x07, 0xe6, 0xdb, 0xc7, 0x2d, 0xec, 0x83, 0xa1, 0x56, 0xe4, 0x1d, 0x3c, 0x26, 0xa1, 0xa5, 0x09, 0x2b, 0xe8,
            0x7d, 0x62, 0xbe, 0xb2, 0x75, 0x94, 0xdd, 0x08, 0xf2, 0x7f, 0x28, 0x41, 0xe4, 0x80, 0x67, 0x02, 0x4e, 0x8a,
            0x8f, 0xc3, 0x35, 0xd0, 0xd5, 0xa9, 0x27, 0x28, 0xea, 0xd2, 0xf4, 0xab, 0x06, 0x86, 0x43, 0xae, 0x8c, 0xe3,
            0xf9, 0x88, 0x7d, 0xe0, 0xdb, 0xbd, 0x42, 0x81, 0x80, 0x02, 0x12, 0x75, 0xb2, 0xe8, 0x17, 0x71, 0xab, 0x21,
            0x95, 0x31, 0x46, 0x42, 0x0d, 0x88, 0x10, 0x39, 0xd3, 0x6f, 0xec, 0x2f, 0x42, 0xea, 0x40, 0x53, 0x62, 0xbf,
            0xeb, 0xca, 0x78, 0x9e, 0xab, 0xa2, 0xd5, 0x2e, 0x05, 0xea, 0x33, 0xab, 0xe9, 0xd6, 0x97, 0x94, 0x42, 0x5e,
            0x04, 0xed, 0x2c, 0xed, 0x6a, 0x9c, 0x7a, 0x95, 0x7d, 0x05, 0x2a, 0x05, 0x7f, 0x08, 0x5d, 0x66, 0xad, 0x61,
            0xd4, 0x76, 0xac, 0x75, 0x96, 0x97, 0x73, 0x63, 0xbd, 0x1a, 0x41, 0x59, 0x29, 0xa5, 0x5e, 0x22, 0x83, 0xc3,
            0x8b, 0x59, 0xfa, 0x9a, 0xa2, 0xf6, 0xbd, 0x30, 0xbf, 0x72, 0x1d, 0x1c, 0x99, 0x86, 0x9c, 0xf2, 0x85, 0x3c,
            0x1d, 0xf7, 0x26, 0x96, 0x2f, 0x2e, 0xf9, 0x02, 0xb1, 0xb5, 0xa9, 0x50, 0xe8, 0x38, 0xfa, 0x9b, 0x0a, 0x5e,
            0xb4, 0x04, 0xc0, 0xce, 0x4e, 0x39, 0x2c, 0xca, 0x0b, 0x5b, 0x62, 0xf0, 0x4d, 0x58, 0x50, 0x34, 0x99, 0xe6,
            0x9a, 0x2c, 0xd2, 0x90, 0xd7, 0x09, 0x81, 0xd6, 0xc0, 0xaa, 0x5e, 0xce, 0xfe, 0xd2, 0xf7, 0xa1, 0xba, 0x4b,
            0xd9, 0xd6, 0x86, 0x8e, 0x19, 0x1f, 0xa6, 0x06, 0x47, 0x42, 0x72, 0xe0, 0x56, 0x0a, 0x00, 0x1c, 0x78, 0xb9,
            0x8d, 0xcc, 0x99, 0x04, 0x37, 0x49};

    result = lookuper.proceed(DLUPD_INCOMING, IPPROTO_TCP, SERVER_CERT.data(), SERVER_CERT.size());
    ASSERT_EQ(result.status, DLUS_FOUND);
    ASSERT_EQ(result.domain, "ya.ru");
}

class TLSExchangeSplittedPackets : public testing::Test {
public:
    DomainLookuper lookuper = {};
    DomainLookuperResult result = {};

    TLSExchangeSplittedPackets() {
        ag::Logger::set_log_level(ag::LOG_LEVEL_TRACE);
    }

    void SetUp() override {
        result = {};
        static const std::vector<uint8_t> CLIENT_HELLO_NOSNI = {0x16, 0x03, 0x01, 0x01, 0x2C, 0x01, 0x00, 0x01, 0x28,
                0x03, 0x03, 0x77, 0xB6, 0x93, 0xFB, 0xA0, 0xE5, 0x3F, 0xA2, 0x3E, 0x44, 0x04, 0x1B, 0x54, 0x18, 0x44,
                0x1B, 0x1D, 0x16, 0x27, 0x6B, 0x73, 0x2B, 0xBE, 0xDC, 0x38, 0xA2, 0x88, 0xAB, 0x9E, 0x4D, 0xC2, 0x7E,
                0x00, 0x00, 0xAA, 0xC0, 0x30, 0xC0, 0x2C, 0xC0, 0x28, 0xC0, 0x24, 0xC0, 0x14, 0xC0, 0x0A, 0x00, 0xA5,
                0x00, 0xA3, 0x00, 0xA1, 0x00, 0x9F, 0x00, 0x6B, 0x00, 0x6A, 0x00, 0x69, 0x00, 0x68, 0x00, 0x39, 0x00,
                0x38, 0x00, 0x37, 0x00, 0x36, 0x00, 0x88, 0x00, 0x87, 0x00, 0x86, 0x00, 0x85, 0xC0, 0x32, 0xC0, 0x2E,
                0xC0, 0x2A, 0xC0, 0x26, 0xC0, 0x0F, 0xC0, 0x05, 0x00, 0x9D, 0x00, 0x3D, 0x00, 0x35, 0x00, 0x84, 0xC0,
                0x2F, 0xC0, 0x2B, 0xC0, 0x27, 0xC0, 0x23, 0xC0, 0x13, 0xC0, 0x09, 0x00, 0xA4, 0x00, 0xA2, 0x00, 0xA0,
                0x00, 0x9E, 0x00, 0x67, 0x00, 0x40, 0x00, 0x3F, 0x00, 0x3E, 0x00, 0x33, 0x00, 0x32, 0x00, 0x31, 0x00,
                0x30, 0x00, 0x9A, 0x00, 0x99, 0x00, 0x98, 0x00, 0x97, 0x00, 0x45, 0x00, 0x44, 0x00, 0x43, 0x00, 0x42,
                0xC0, 0x31, 0xC0, 0x2D, 0xC0, 0x29, 0xC0, 0x25, 0xC0, 0x0E, 0xC0, 0x04, 0x00, 0x9C, 0x00, 0x3C, 0x00,
                0x2F, 0x00, 0x96, 0x00, 0x41, 0xC0, 0x11, 0xC0, 0x07, 0xC0, 0x0C, 0xC0, 0x02, 0x00, 0x05, 0x00, 0x04,
                0xC0, 0x12, 0xC0, 0x08, 0x00, 0x16, 0x00, 0x13, 0x00, 0x10, 0x00, 0x0D, 0xC0, 0x0D, 0xC0, 0x03, 0x00,
                0x0A, 0x00, 0xFF, 0x01, 0x00, 0x00, 0x55, 0x00, 0x0B, 0x00, 0x04, 0x03, 0x00, 0x01, 0x02, 0x00, 0x0A,
                0x00, 0x1C, 0x00, 0x1A, 0x00, 0x17, 0x00, 0x19, 0x00, 0x1C, 0x00, 0x1B, 0x00, 0x18, 0x00, 0x1A, 0x00,
                0x16, 0x00, 0x0E, 0x00, 0x0D, 0x00, 0x0B, 0x00, 0x0C, 0x00, 0x09, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x00,
                0x00, 0x0D, 0x00, 0x20, 0x00, 0x1E, 0x06, 0x01, 0x06, 0x02, 0x06, 0x03, 0x05, 0x01, 0x05, 0x02, 0x05,
                0x03, 0x04, 0x01, 0x04, 0x02, 0x04, 0x03, 0x03, 0x01, 0x03, 0x02, 0x03, 0x03, 0x02, 0x01, 0x02, 0x02,
                0x02, 0x03, 0x00, 0x0F, 0x00, 0x01, 0x01};
        result = lookuper.proceed(DLUPD_OUTGOING, IPPROTO_TCP, CLIENT_HELLO_NOSNI.data(), 1);
        ASSERT_EQ(result.status, DLUS_WANT_MORE);

        result = lookuper.proceed(
                DLUPD_OUTGOING, IPPROTO_TCP, CLIENT_HELLO_NOSNI.data() + 1, CLIENT_HELLO_NOSNI.size() - 1);
        ASSERT_EQ(result.status, DLUS_PASS);
    }
};

TEST_F(TLSExchangeSplittedPackets, Test) {
    static const std::vector<uint8_t> SERVER_HELLO = {0x16, 0x03, 0x03, 0x00, 0x42, 0x02, 0x00, 0x00, 0x3e, 0x03, 0x03,
            0xf9, 0xcb, 0x24, 0xe7, 0x0b, 0x82, 0x43, 0x12, 0x1f, 0x6a, 0xc5, 0xfd, 0x36, 0x5f, 0x95, 0xf4, 0x8b, 0x16,
            0xde, 0x1f, 0xbd, 0xbb, 0xff, 0x56, 0x00, 0x7c, 0x3d, 0xc5, 0xef, 0x28, 0xae, 0x06, 0x00, 0xc0, 0x2f, 0x00,
            0x00, 0x16, 0xff, 0x01, 0x00, 0x01, 0x00, 0x00, 0x0b, 0x00, 0x04, 0x03, 0x00, 0x01, 0x02, 0x00, 0x23, 0x00,
            0x00, 0x00, 0x0f, 0x00, 0x01, 0x01};

    result = lookuper.proceed(DLUPD_INCOMING, IPPROTO_TCP, SERVER_HELLO.data(), SERVER_HELLO.size());
    ASSERT_EQ(result.status, DLUS_PASS);

    static const std::vector<uint8_t> SERVER_CERT = {0x16, 0x03, 0x03, 0x0f, 0x84, 0x0b, 0x00, 0x0f, 0x80, 0x00, 0x0f,
            0x7d, 0x00, 0x06, 0x10, 0x30, 0x82, 0x06, 0x0c, 0x30, 0x82, 0x04, 0xf4, 0xa0, 0x03, 0x02, 0x01, 0x02, 0x02,
            0x10, 0x30, 0x60, 0x21, 0xa9, 0xc0, 0xcc, 0x76, 0x97, 0x87, 0x1d, 0xe5, 0xa8, 0x4d, 0x8e, 0xf9, 0x97, 0x30,
            0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x0b, 0x05, 0x00, 0x30, 0x5f, 0x31, 0x0b,
            0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x52, 0x55, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55,
            0x04, 0x0a, 0x13, 0x0a, 0x59, 0x61, 0x6e, 0x64, 0x65, 0x78, 0x20, 0x4c, 0x4c, 0x43, 0x31, 0x27, 0x30, 0x25,
            0x06, 0x03, 0x55, 0x04, 0x0b, 0x13, 0x1e, 0x59, 0x61, 0x6e, 0x64, 0x65, 0x78, 0x20, 0x43, 0x65, 0x72, 0x74,
            0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x20, 0x41, 0x75, 0x74, 0x68, 0x6f, 0x72, 0x69, 0x74,
            0x79, 0x31, 0x12, 0x30, 0x10, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x09, 0x59, 0x61, 0x6e, 0x64, 0x65, 0x78,
            0x20, 0x43, 0x41, 0x30, 0x1e, 0x17, 0x0d, 0x31, 0x37, 0x30, 0x36, 0x32, 0x31, 0x31, 0x37, 0x31, 0x38, 0x32,
            0x33, 0x5a, 0x17, 0x0d, 0x31, 0x39, 0x30, 0x36, 0x32, 0x31, 0x31, 0x37, 0x31, 0x38, 0x32, 0x33, 0x5a, 0x30,
            0x6e, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x52, 0x55, 0x31, 0x13, 0x30, 0x11,
            0x06, 0x03, 0x55, 0x04, 0x0a, 0x0c, 0x0a, 0x59, 0x61, 0x6e, 0x64, 0x65, 0x78, 0x20, 0x4c, 0x4c, 0x43, 0x31,
            0x0c, 0x30, 0x0a, 0x06, 0x03, 0x55, 0x04, 0x0b, 0x0c, 0x03, 0x49, 0x54, 0x4f, 0x31, 0x0f, 0x30, 0x0d, 0x06,
            0x03, 0x55, 0x04, 0x07, 0x0c, 0x06, 0x4d, 0x6f, 0x73, 0x63, 0x6f, 0x77, 0x31, 0x1b, 0x30, 0x19, 0x06, 0x03,
            0x55, 0x04, 0x08, 0x0c, 0x12, 0x52, 0x75, 0x73, 0x73, 0x69, 0x61, 0x6e, 0x20, 0x46, 0x65, 0x64, 0x65, 0x72,
            0x61, 0x74, 0x69, 0x6f, 0x6e, 0x31, 0x0e, 0x30, 0x0c, 0x06, 0x03, 0x55, 0x04, 0x03, 0x0c, 0x05, 0x79, 0x61,
            0x2e, 0x72, 0x75, 0x30, 0x82, 0x01, 0x22, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01,
            0x01, 0x01, 0x05, 0x00, 0x03, 0x82, 0x01, 0x0f, 0x00, 0x30, 0x82, 0x01, 0x0a, 0x02, 0x82, 0x01, 0x01, 0x00,
            0xe5, 0x72, 0xfe, 0x46, 0x49, 0x06, 0x78, 0x78, 0x99, 0x36, 0x62, 0x9b, 0xe3, 0xfb, 0xf3, 0xe2, 0x08, 0xdc,
            0xca, 0x1e, 0x89, 0xd2, 0x34, 0x27, 0x66, 0x0d, 0x20, 0x8a, 0x57, 0xc5, 0xee, 0xe0, 0x25, 0xda, 0x6b, 0x11,
            0xfb, 0x9f, 0x24, 0xd9, 0x6d, 0xcc, 0xe7, 0x5e, 0xbe, 0x11, 0x67, 0x67, 0xa8, 0xe3, 0xe7, 0x39, 0xe7, 0x3c,
            0x39, 0xc2, 0xa7, 0xcb, 0xba, 0x5f, 0xc8, 0x90, 0x61, 0x61, 0x04, 0xa7, 0x7b, 0xdf, 0xcd, 0x03, 0xce, 0x42,
            0x37, 0x7c, 0x07, 0xbd, 0x0d, 0x91, 0x16, 0x27, 0x5e, 0xec, 0x52, 0xdc, 0xb1, 0x4e, 0x65, 0x9b, 0xcb, 0xd5,
            0xb0, 0xf0, 0xcf, 0x4e, 0x62, 0xbe, 0xf3, 0x5a, 0x05, 0x3f, 0xa0, 0x83, 0x7e, 0xe5, 0x2e, 0xeb, 0x5e, 0xd8,
            0x3f, 0x37, 0x74, 0x2c, 0x4a, 0x31, 0xc6, 0x9d, 0xdf, 0xe3, 0x8c, 0x55, 0x3f, 0x18, 0x49, 0x26, 0x52, 0x99,
            0x53, 0x0e, 0x1c, 0xcf, 0xa2, 0x5d, 0x9b, 0x5c, 0x23, 0x74, 0xd4, 0x89, 0x0d, 0x1e, 0xdc, 0x3e, 0x3f, 0xe7,
            0xab, 0x4d, 0xd7, 0x22, 0xa8, 0x8e, 0xb1, 0x25, 0x27, 0xb1, 0x56, 0x83, 0xf2, 0x29, 0xbb, 0x46, 0xd1, 0x66,
            0x54, 0x37, 0xbb, 0xf2, 0xf3, 0x80, 0x4f, 0xf9, 0xde, 0xc5, 0x46, 0xec, 0xce, 0x69, 0x7e, 0xa9, 0x50, 0x8d,
            0xe8, 0x0e, 0x31, 0xad, 0x5c, 0x48, 0xc5, 0xe1, 0xc7, 0x81, 0x1d, 0x6b, 0x2d, 0xfd, 0x92, 0xaa, 0x1f, 0x80,
            0xe4, 0xf6, 0xcf, 0xdf, 0xce, 0x3e, 0x79, 0x26, 0x82, 0xe4, 0x92, 0x99, 0x74, 0x88, 0x70, 0xe8, 0xe5, 0x7b,
            0xc7, 0x44, 0xf7, 0xe0, 0xaa, 0x7a, 0x77, 0x60, 0xd0, 0x53, 0x8f, 0x09, 0x9a, 0x8b, 0xb4, 0x1c, 0xb8, 0xcf,
            0x80, 0x0b, 0x32, 0x6e, 0xdf, 0xa4, 0x6b, 0x2e, 0x0c, 0x94, 0x57, 0x90, 0x7d, 0x23, 0x32, 0x19, 0x32, 0x3e,
            0x99, 0xf5, 0x30, 0xb3, 0x02, 0x03, 0x01, 0x00, 0x01, 0xa3, 0x82, 0x02, 0xb3, 0x30, 0x82, 0x02, 0xaf, 0x30,
            0x0c, 0x06, 0x03, 0x55, 0x1d, 0x13, 0x01, 0x01, 0xff, 0x04, 0x02, 0x30, 0x00, 0x30, 0x69, 0x06, 0x03, 0x55,
            0x1d, 0x1f, 0x04, 0x62, 0x30, 0x60, 0x30, 0x2f, 0xa0, 0x2d, 0xa0, 0x2b, 0x86, 0x29, 0x68, 0x74, 0x74, 0x70,
            0x3a, 0x2f, 0x2f, 0x63, 0x72, 0x6c, 0x73, 0x2e, 0x79, 0x61, 0x6e, 0x64, 0x65, 0x78, 0x2e, 0x6e, 0x65, 0x74,
            0x2f, 0x63, 0x65, 0x72, 0x74, 0x75, 0x6d, 0x2f, 0x79, 0x63, 0x61, 0x73, 0x68, 0x61, 0x32, 0x2e, 0x63, 0x72,
            0x6c, 0x30, 0x2d, 0xa0, 0x2b, 0xa0, 0x29, 0x86, 0x27, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x79, 0x61,
            0x6e, 0x64, 0x65, 0x78, 0x2e, 0x63, 0x72, 0x6c, 0x2e, 0x63, 0x65, 0x72, 0x74, 0x75, 0x6d, 0x2e, 0x70, 0x6c,
            0x2f, 0x79, 0x63, 0x61, 0x73, 0x68, 0x61, 0x32, 0x2e, 0x63, 0x72, 0x6c, 0x30, 0x71, 0x06, 0x08, 0x2b, 0x06,
            0x01, 0x05, 0x05, 0x07, 0x01, 0x01, 0x04, 0x65, 0x30, 0x63, 0x30, 0x2c, 0x06, 0x08, 0x2b, 0x06, 0x01, 0x05,
            0x05, 0x07, 0x30, 0x01, 0x86, 0x20, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x79, 0x61, 0x6e, 0x64, 0x65,
            0x78, 0x2e, 0x6f, 0x63, 0x73, 0x70, 0x2d, 0x72, 0x65, 0x73, 0x70, 0x6f, 0x6e, 0x64, 0x65, 0x72, 0x2e, 0x63,
            0x6f, 0x6d, 0x30, 0x33, 0x06, 0x08, 0x2b, 0x06, 0x01, 0x05, 0x05, 0x07, 0x30, 0x02, 0x86, 0x27, 0x68, 0x74,
            0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x72, 0x65, 0x70, 0x6f, 0x73, 0x69, 0x74, 0x6f, 0x72, 0x79, 0x2e, 0x63, 0x65,
            0x72, 0x74, 0x75, 0x6d, 0x2e, 0x70, 0x6c, 0x2f, 0x79, 0x63, 0x61, 0x73, 0x68, 0x61, 0x32, 0x2e, 0x63, 0x65,
            0x72, 0x30, 0x1f, 0x06, 0x03, 0x55, 0x1d, 0x23, 0x04, 0x18, 0x30, 0x16, 0x80, 0x14, 0x37, 0x5c, 0xe3, 0x19,
            0xe0, 0xb2, 0x8e, 0xa1, 0xa8, 0x4e, 0xd2, 0xcf, 0xab, 0xd0, 0xdc, 0xe3, 0x0b, 0x5c, 0x35, 0x4d, 0x30, 0x1d,
            0x06, 0x03, 0x55, 0x1d, 0x0e, 0x04, 0x16, 0x04, 0x14, 0xb8, 0xd8, 0x0f, 0x12, 0xe2, 0xb8, 0xee, 0x01, 0x9b,
            0xa1, 0x8d, 0xa9, 0x51, 0x16, 0xdb, 0x29, 0xd5, 0x93, 0x83, 0xcc, 0x30, 0x0e, 0x06, 0x03, 0x55, 0x1d, 0x0f,
            0x01, 0x01, 0xff, 0x04, 0x04, 0x03, 0x02, 0x05, 0xa0, 0x30, 0x82, 0x01, 0x17, 0x06, 0x03, 0x55, 0x1d, 0x20,
            0x04, 0x82, 0x01, 0x0e, 0x30, 0x82, 0x01, 0x0a, 0x30, 0x82, 0x01, 0x06, 0x06, 0x0c, 0x2a, 0x84, 0x68, 0x01,
            0x86, 0xf6, 0x77, 0x02, 0x05, 0x01, 0x0a, 0x02, 0x30, 0x81, 0xf5, 0x30, 0x81, 0xf2, 0x06, 0x08, 0x2b, 0x06,
            0x01, 0x05, 0x05, 0x07, 0x02, 0x02, 0x30, 0x81, 0xe5, 0x30, 0x20, 0x16, 0x19, 0x55, 0x6e, 0x69, 0x7a, 0x65,
            0x74, 0x6f, 0x20, 0x54, 0x65, 0x63, 0x68, 0x6e, 0x6f, 0x6c, 0x6f, 0x67, 0x69, 0x65, 0x73, 0x20, 0x53, 0x2e,
            0x41, 0x2e, 0x30, 0x03, 0x02, 0x01, 0x02, 0x1a, 0x81, 0xc0, 0x55, 0x73, 0x61, 0x67, 0x65, 0x20, 0x6f, 0x66,
            0x20, 0x74, 0x68, 0x69, 0x73, 0x20, 0x63, 0x65, 0x72, 0x74, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x65, 0x20,
            0x69, 0x73, 0x20, 0x73, 0x74, 0x72, 0x69, 0x63, 0x74, 0x6c, 0x79, 0x20, 0x73, 0x75, 0x62, 0x6a, 0x65, 0x63,
            0x74, 0x65, 0x64, 0x20, 0x74, 0x6f, 0x20, 0x74, 0x68, 0x65, 0x20, 0x43, 0x45, 0x52, 0x54, 0x55, 0x4d, 0x20,
            0x43, 0x65, 0x72, 0x74, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x20, 0x50, 0x72, 0x61, 0x63,
            0x74, 0x69, 0x63, 0x65, 0x20, 0x53, 0x74, 0x61, 0x74, 0x65, 0x6d, 0x65, 0x6e, 0x74, 0x20, 0x28, 0x43, 0x50,
            0x53, 0x29, 0x20, 0x69, 0x6e, 0x63, 0x6f, 0x72, 0x70, 0x6f, 0x72, 0x61, 0x74, 0x65, 0x64, 0x20, 0x62, 0x79,
            0x20, 0x72, 0x65, 0x66, 0x65, 0x72, 0x65, 0x6e, 0x63, 0x65, 0x20, 0x68, 0x65, 0x72, 0x65, 0x69, 0x6e, 0x20,
            0x61, 0x6e, 0x64, 0x20, 0x69, 0x6e, 0x20, 0x74, 0x68, 0x65, 0x20, 0x72, 0x65, 0x70, 0x6f, 0x73, 0x69, 0x74,
            0x6f, 0x72, 0x79, 0x20, 0x61, 0x74, 0x20, 0x68, 0x74, 0x74, 0x70, 0x73, 0x3a, 0x2f, 0x2f, 0x77, 0x77, 0x77,
            0x2e, 0x63, 0x65, 0x72, 0x74, 0x75, 0x6d, 0x2e, 0x70, 0x6c, 0x2f, 0x72, 0x65, 0x70, 0x6f, 0x73, 0x69, 0x74,
            0x6f, 0x72, 0x79, 0x2e, 0x30, 0x1d, 0x06, 0x03, 0x55, 0x1d, 0x25, 0x04, 0x16, 0x30, 0x14, 0x06, 0x08, 0x2b,
            0x06, 0x01, 0x05, 0x05, 0x07, 0x03, 0x01, 0x06, 0x08, 0x2b, 0x06, 0x01, 0x05, 0x05, 0x07, 0x03, 0x02, 0x30,
            0x11, 0x06, 0x09, 0x60, 0x86, 0x48, 0x01, 0x86, 0xf8, 0x42, 0x01, 0x01, 0x04, 0x04, 0x03, 0x02, 0x06, 0xc0,
            0x30, 0x24, 0x06, 0x03, 0x55, 0x1d, 0x11, 0x04, 0x1d, 0x30, 0x1b, 0x82, 0x05, 0x79, 0x61, 0x2e, 0x72, 0x75,
            0x82, 0x09, 0x77, 0x77, 0x77, 0x2e, 0x79, 0x61, 0x2e, 0x72, 0x75, 0x82, 0x07, 0x6d, 0x2e, 0x79, 0x61, 0x2e,
            0x72, 0x75, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x0b, 0x05, 0x00, 0x03,
            0x82, 0x01, 0x01, 0x00, 0x07, 0x1c, 0x40, 0xfc, 0x15, 0xb0, 0x96, 0xf6, 0xad, 0xd7, 0x9b, 0x0f, 0x22, 0x92,
            0x79, 0xbf, 0x25, 0x29, 0x74, 0x38, 0x24, 0x8a, 0x07, 0x4b, 0xe5, 0x70, 0xc8, 0xc2, 0xfd, 0x86, 0xdc, 0xfd,
            0x47, 0x46, 0xf8, 0x8d, 0x15, 0xe1, 0x63, 0xef, 0x38, 0xaa, 0x00, 0xaf, 0x25, 0x34, 0x80, 0xc1, 0x61, 0x1a,
            0x0d, 0x53, 0x5d, 0xb6, 0x98, 0xef, 0x4e, 0x5b, 0xfe, 0x89, 0x6b, 0x3f, 0x89, 0x60, 0x41, 0x54, 0x11, 0xe5,
            0x9f, 0x0a, 0x7e, 0xe0, 0x72, 0x05, 0x19, 0xc0, 0x08, 0xc9, 0x1f, 0xb6, 0x30, 0xe2, 0xf4, 0xf1, 0xdc, 0x65,
            0x2c, 0x9b, 0xe0, 0x19, 0x06, 0x39, 0x91, 0x94, 0xb0, 0x12, 0x22, 0x67, 0x72, 0x80, 0x84, 0x4f, 0x4d, 0x92,
            0x93, 0x49, 0xb9, 0x7a, 0x06, 0xe7, 0x18, 0xc7, 0x02, 0xc7, 0x3a, 0x7a, 0xdb, 0x8e, 0x54, 0xd2, 0x94, 0xbf,
            0xf1, 0xc6, 0xf8, 0x3d, 0x81, 0x44, 0xb4, 0x88, 0xb9, 0x4f, 0xd5, 0x34, 0xb5, 0x8b, 0x81, 0x36, 0x5f, 0x6c,
            0xd2, 0xa7, 0xe1, 0xa6, 0x1e, 0xb9, 0x11, 0xac, 0x8f, 0x29, 0x60, 0xf9, 0xb0, 0xa0, 0x76, 0xe6, 0xae, 0x9f,
            0x49, 0x3c, 0x1f, 0xc1, 0x21, 0x89, 0x09, 0x91, 0x70, 0x5b, 0x43, 0xa7, 0xf9, 0x87, 0xac, 0xc1, 0x64, 0x97,
            0x9c, 0x79, 0x11, 0xca, 0xe6, 0xa3, 0xcf, 0x8d, 0x66, 0x40, 0x72, 0x46, 0x52, 0x24, 0x08, 0x14, 0xea, 0x7d,
            0x73, 0x1f, 0x69, 0x31, 0x10, 0xf3, 0x2a, 0x5d, 0xf6, 0xd6, 0x9a, 0x6c, 0x85, 0x5c, 0x6d, 0x02, 0xe5, 0xaf,
            0xc2, 0x3d, 0x12, 0xb3, 0x94, 0x01, 0x22, 0x79, 0x15, 0xed, 0x36, 0x16, 0x61, 0xc2, 0xea, 0xd5, 0x37, 0x50,
            0x0d, 0x61, 0xa8, 0x49, 0xd6, 0xe1, 0x5c, 0x89, 0x5d, 0x33, 0x23, 0x3f, 0xaf, 0xf8, 0xc1, 0x6e, 0xfc, 0xbd,
            0xd8, 0x5f, 0x97, 0xba, 0xe6, 0x7d, 0xd6, 0xa3, 0x00, 0x04, 0xac, 0x30, 0x82, 0x04, 0xa8, 0x30, 0x82, 0x03,
            0x90, 0xa0, 0x03, 0x02, 0x01, 0x02, 0x02, 0x11, 0x00, 0xe4, 0x05, 0x47, 0x83, 0x0e, 0x0c, 0x64, 0x52, 0x97,
            0x6f, 0x7a, 0x35, 0x49, 0xc0, 0xdd, 0x48, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01,
            0x01, 0x0b, 0x05, 0x00, 0x30, 0x7e, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x50,
            0x4c, 0x31, 0x22, 0x30, 0x20, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13, 0x19, 0x55, 0x6e, 0x69, 0x7a, 0x65, 0x74,
            0x6f, 0x20, 0x54, 0x65, 0x63, 0x68, 0x6e, 0x6f, 0x6c, 0x6f, 0x67, 0x69, 0x65, 0x73, 0x20, 0x53, 0x2e, 0x41,
            0x2e, 0x31, 0x27, 0x30, 0x25, 0x06, 0x03, 0x55, 0x04, 0x0b, 0x13, 0x1e, 0x43, 0x65, 0x72, 0x74, 0x75, 0x6d,
            0x20, 0x43, 0x65, 0x72, 0x74, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x20, 0x41, 0x75, 0x74,
            0x68, 0x6f, 0x72, 0x69, 0x74, 0x79, 0x31, 0x22, 0x30, 0x20, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x19, 0x43,
            0x65, 0x72, 0x74, 0x75, 0x6d, 0x20, 0x54, 0x72, 0x75, 0x73, 0x74, 0x65, 0x64, 0x20, 0x4e, 0x65, 0x74, 0x77,
            0x6f, 0x72, 0x6b, 0x20, 0x43, 0x41, 0x30, 0x1e, 0x17, 0x0d, 0x31, 0x35, 0x30, 0x31, 0x32, 0x31, 0x31, 0x32,
            0x30, 0x30, 0x30, 0x30, 0x5a, 0x17, 0x0d, 0x32, 0x35, 0x30, 0x31, 0x31, 0x38, 0x31, 0x32, 0x30, 0x30, 0x30,
            0x30, 0x5a, 0x30, 0x5f, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x52, 0x55, 0x31,
            0x13, 0x30, 0x11, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13, 0x0a, 0x59, 0x61, 0x6e, 0x64, 0x65, 0x78, 0x20, 0x4c,
            0x4c, 0x43, 0x31, 0x27, 0x30, 0x25, 0x06, 0x03, 0x55, 0x04, 0x0b, 0x13, 0x1e, 0x59, 0x61, 0x6e, 0x64, 0x65,
            0x78, 0x20, 0x43, 0x65, 0x72, 0x74, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x20, 0x41, 0x75,
            0x74, 0x68, 0x6f, 0x72, 0x69, 0x74, 0x79, 0x31, 0x12, 0x30, 0x10, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x09,
            0x59, 0x61, 0x6e, 0x64, 0x65, 0x78, 0x20, 0x43, 0x41, 0x30, 0x82, 0x01, 0x22, 0x30, 0x0d, 0x06, 0x09, 0x2a,
            0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x82, 0x01, 0x0f, 0x00, 0x30, 0x82, 0x01,
            0x0a, 0x02, 0x82, 0x01, 0x01, 0x00, 0xa6, 0x05, 0x24, 0x76, 0x61, 0xb9, 0x9e, 0x42, 0x60, 0x22, 0x63, 0x85,
            0x59, 0xe5, 0x9d, 0x88, 0x0d, 0xdf, 0xef, 0x21, 0x64, 0x5a, 0x26, 0x94, 0x71, 0x3a, 0xa4, 0x7f, 0x2b, 0x53,
            0xc3, 0xac, 0x7b, 0xba, 0x95, 0x42, 0x6d, 0x6a, 0x5b, 0xd6, 0x7e, 0x78, 0x0c, 0x67, 0x40, 0x98, 0x2f, 0x6a,
            0x2d, 0xd0, 0xb7, 0x18, 0x3a, 0x7e, 0x99, 0x60, 0x01, 0xe5, 0x27, 0xbf, 0xff, 0x49, 0xf5, 0xcd, 0xc4, 0x58,
            0xc3, 0x4c, 0xe1, 0x70, 0xd5, 0xfd, 0x08, 0xa8, 0x79, 0x95, 0x76, 0x1c, 0x0e, 0x05, 0x41, 0xfa, 0xbd, 0x80,
            0x38, 0x2a, 0x87, 0x4f, 0xc1, 0x67, 0x42, 0xaa, 0x17, 0xa6, 0xee, 0xa7, 0x8c, 0x8e, 0xef, 0x2d, 0x7f, 0x7a,
            0x1d, 0x05, 0x17, 0x8f, 0x7e, 0x3b, 0x92, 0x35, 0xf5, 0x68, 0xed, 0x93, 0x03, 0x55, 0x23, 0x4f, 0x4b, 0xa2,
            0x00, 0x86, 0x65, 0x91, 0x0f, 0xeb, 0xf6, 0x3c, 0xd5, 0xdb, 0x6d, 0x0e, 0xed, 0xe8, 0x7c, 0x3a, 0xc8, 0xba,
            0xb7, 0x53, 0xc1, 0xa4, 0xd8, 0x40, 0x02, 0xe5, 0xb5, 0xa2, 0xca, 0xbf, 0xda, 0x9c, 0x94, 0x0d, 0xfc, 0xc5,
            0x1c, 0x2a, 0x59, 0x88, 0x62, 0x57, 0x93, 0x2e, 0x11, 0xf0, 0x38, 0x2c, 0x7a, 0x81, 0x2a, 0xf2, 0x25, 0x15,
            0x17, 0x35, 0x70, 0x2c, 0x4b, 0xf7, 0x23, 0x4c, 0x82, 0xef, 0x33, 0x9f, 0xc2, 0x9a, 0x0b, 0xa3, 0xe2, 0x5d,
            0x6b, 0x38, 0x77, 0xf9, 0x60, 0x33, 0xcf, 0x2e, 0x7b, 0x56, 0xb7, 0x13, 0x93, 0x1f, 0x34, 0x97, 0x71, 0x99,
            0x76, 0x02, 0x46, 0x35, 0x14, 0x7c, 0xdc, 0xca, 0x48, 0x8a, 0x0a, 0x72, 0x4b, 0x78, 0x6d, 0x82, 0x34, 0x96,
            0x13, 0x45, 0xcf, 0x02, 0x2f, 0x50, 0x13, 0x39, 0x43, 0x89, 0xc0, 0xe1, 0x74, 0xd7, 0x28, 0x71, 0x21, 0xe5,
            0xaa, 0x97, 0x0e, 0xee, 0x46, 0xec, 0x93, 0xf7, 0x23, 0x7d, 0x02, 0x03, 0x01, 0x00, 0x01, 0xa3, 0x82, 0x01,
            0x3e, 0x30, 0x82, 0x01, 0x3a, 0x30, 0x0f, 0x06, 0x03, 0x55, 0x1d, 0x13, 0x01, 0x01, 0xff, 0x04, 0x05, 0x30,
            0x03, 0x01, 0x01, 0xff, 0x30, 0x1d, 0x06, 0x03, 0x55, 0x1d, 0x0e, 0x04, 0x16, 0x04, 0x14, 0x37, 0x5c, 0xe3,
            0x19, 0xe0, 0xb2, 0x8e, 0xa1, 0xa8, 0x4e, 0xd2, 0xcf, 0xab, 0xd0, 0xdc, 0xe3, 0x0b, 0x5c, 0x35, 0x4d, 0x30,
            0x1f, 0x06, 0x03, 0x55, 0x1d, 0x23, 0x04, 0x18, 0x30, 0x16, 0x80, 0x14, 0x08, 0x76, 0xcd, 0xcb, 0x07, 0xff,
            0x24, 0xf6, 0xc5, 0xcd, 0xed, 0xbb, 0x90, 0xbc, 0xe2, 0x84, 0x37, 0x46, 0x75, 0xf7, 0x30, 0x0e, 0x06, 0x03,
            0x55, 0x1d, 0x0f, 0x01, 0x01, 0xff, 0x04, 0x04, 0x03, 0x02, 0x01, 0x06, 0x30, 0x2f, 0x06, 0x03, 0x55, 0x1d,
            0x1f, 0x04, 0x28, 0x30, 0x26, 0x30, 0x24, 0xa0, 0x22, 0xa0, 0x20, 0x86, 0x1e, 0x68, 0x74, 0x74, 0x70, 0x3a,
            0x2f, 0x2f, 0x63, 0x72, 0x6c, 0x2e, 0x63, 0x65, 0x72, 0x74, 0x75, 0x6d, 0x2e, 0x70, 0x6c, 0x2f, 0x63, 0x74,
            0x6e, 0x63, 0x61, 0x2e, 0x63, 0x72, 0x6c, 0x30, 0x6b, 0x06, 0x08, 0x2b, 0x06, 0x01, 0x05, 0x05, 0x07, 0x01,
            0x01, 0x04, 0x5f, 0x30, 0x5d, 0x30, 0x28, 0x06, 0x08, 0x2b, 0x06, 0x01, 0x05, 0x05, 0x07, 0x30, 0x01, 0x86,
            0x1c, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x73, 0x75, 0x62, 0x63, 0x61, 0x2e, 0x6f, 0x63, 0x73, 0x70,
            0x2d, 0x63, 0x65, 0x72, 0x74, 0x75, 0x6d, 0x2e, 0x63, 0x6f, 0x6d, 0x30, 0x31, 0x06, 0x08, 0x2b, 0x06, 0x01,
            0x05, 0x05, 0x07, 0x30, 0x02, 0x86, 0x25, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x72, 0x65, 0x70, 0x6f,
            0x73, 0x69, 0x74, 0x6f, 0x72, 0x79, 0x2e, 0x63, 0x65, 0x72, 0x74, 0x75, 0x6d, 0x2e, 0x70, 0x6c, 0x2f, 0x63,
            0x74, 0x6e, 0x63, 0x61, 0x2e, 0x63, 0x65, 0x72, 0x30, 0x39, 0x06, 0x03, 0x55, 0x1d, 0x20, 0x04, 0x32, 0x30,
            0x30, 0x30, 0x2e, 0x06, 0x04, 0x55, 0x1d, 0x20, 0x00, 0x30, 0x26, 0x30, 0x24, 0x06, 0x08, 0x2b, 0x06, 0x01,
            0x05, 0x05, 0x07, 0x02, 0x01, 0x16, 0x18, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x77, 0x77, 0x77, 0x2e,
            0x63, 0x65, 0x72, 0x74, 0x75, 0x6d, 0x2e, 0x70, 0x6c, 0x2f, 0x43, 0x50, 0x53, 0x30, 0x0d, 0x06, 0x09, 0x2a,
            0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x0b, 0x05, 0x00, 0x03, 0x82, 0x01, 0x01, 0x00, 0x02, 0x5e, 0x8e,
            0x7b, 0xe0, 0x66, 0xa1, 0xc6, 0xab, 0x8b, 0x18, 0x1f, 0x0e, 0xb9, 0xc4, 0xcd, 0x71, 0xdb, 0x44, 0x5c, 0x03,
            0x7d, 0x65, 0xea, 0xb8, 0x47, 0xb5, 0x1e, 0xce, 0x24, 0x70, 0xa0, 0x7f, 0xd3, 0xdf, 0x66, 0x4b, 0x8c, 0x90,
            0xe2, 0xa5, 0xed, 0x9b, 0x94, 0x36, 0xb4, 0xa8, 0xbe, 0xf0, 0x74, 0x8c, 0x26, 0x92, 0x75, 0x9d, 0x56, 0x50,
            0x9e, 0xad, 0xd0, 0x1a, 0xa0, 0xdf, 0xa4, 0x14, 0x56, 0x10, 0x75, 0x93, 0x7a, 0xc1, 0xf4, 0x53, 0xa0, 0x76,
            0x74, 0x2c, 0x72, 0xba, 0xb5, 0xd1, 0xc9, 0xe2, 0xdc, 0x46, 0x86, 0x3f, 0x1d, 0xf6, 0x33, 0x87, 0x59, 0xec,
            0x9c, 0xdc, 0x2d, 0x1e, 0x4d, 0x43, 0x1a, 0xce, 0xba, 0xd9, 0x87, 0x7e, 0xe2, 0x47, 0x45, 0x72, 0x3d, 0x28,
            0x03, 0xc9, 0x0a, 0x4d, 0xe0, 0x57, 0xa3, 0x5e, 0x6e, 0x7e, 0xcc, 0x5a, 0xc8, 0xc4, 0x78, 0x01, 0x57, 0x68,
            0x7a, 0x38, 0x3b, 0x53, 0x36, 0xe7, 0x92, 0x6d, 0x8a, 0x2c, 0x2f, 0xd7, 0x8b, 0xb6, 0x34, 0xa8, 0xd1, 0xb6,
            0xf8, 0x5e, 0x3b, 0xab, 0xed, 0xa5, 0x8f, 0x39, 0x6f, 0x45, 0xad, 0xcb, 0x63, 0xed, 0x6a, 0x64, 0xc9, 0x10,
            0xa7, 0x03, 0x08, 0x12, 0x53, 0xb1, 0x1c, 0xaf, 0xca, 0xf7, 0x53, 0xfc, 0xd8, 0x29, 0x4b, 0x1b, 0xfb, 0x38,
            0xcd, 0xc0, 0x63, 0xff, 0x5f, 0xe4, 0xb9, 0x8d, 0x5e, 0xaa, 0x2b, 0xd2, 0xc3, 0x22, 0x35, 0x31, 0xf6, 0x30,
            0x0e, 0x53, 0x32, 0xf4, 0x93, 0xc5, 0x43, 0xcb, 0xc8, 0xf0, 0x15, 0x56, 0x8f, 0x00, 0x19, 0x87, 0xca, 0x78,
            0x22, 0x8d, 0xa0, 0x2e, 0xdb, 0x2f, 0xa0, 0xc3, 0x7e, 0x29, 0x5d, 0x91, 0x25, 0x84, 0x1d, 0x1d, 0x39, 0xab,
            0x1b, 0xc5, 0xd6, 0x91, 0xfe, 0x69, 0x0e, 0x46, 0x80, 0xbc, 0x45, 0x7b, 0x35, 0x53, 0x2a, 0xdf, 0x00, 0xb6,
            0x77, 0x00, 0x04, 0xb8, 0x30, 0x82, 0x04, 0xb4, 0x30, 0x82, 0x03, 0x9c, 0xa0, 0x03, 0x02, 0x01, 0x02, 0x02,
            0x11, 0x00, 0x93, 0x92, 0x85, 0x40, 0x01, 0x65, 0x71, 0x5f, 0x94, 0x7f, 0x28, 0x8f, 0xef, 0xc9, 0x9b, 0x28,
            0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x0b, 0x05, 0x00, 0x30, 0x3e, 0x31,
            0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x50, 0x4c, 0x31, 0x1b, 0x30, 0x19, 0x06, 0x03,
            0x55, 0x04, 0x0a, 0x13, 0x12, 0x55, 0x6e, 0x69, 0x7a, 0x65, 0x74, 0x6f, 0x20, 0x53, 0x70, 0x2e, 0x20, 0x7a,
            0x20, 0x6f, 0x2e, 0x6f, 0x2e, 0x31, 0x12, 0x30, 0x10, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x09, 0x43, 0x65,
            0x72, 0x74, 0x75, 0x6d, 0x20, 0x43, 0x41, 0x30, 0x1e, 0x17, 0x0d, 0x30, 0x38, 0x31, 0x30, 0x32, 0x32, 0x31,
            0x32, 0x30, 0x37, 0x33, 0x37, 0x5a, 0x17, 0x0d, 0x32, 0x37, 0x30, 0x36, 0x31, 0x30, 0x31, 0x30, 0x34, 0x36,
            0x33, 0x39, 0x5a, 0x30, 0x7e, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x50, 0x4c,
            0x31, 0x22, 0x30, 0x20, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13, 0x19, 0x55, 0x6e, 0x69, 0x7a, 0x65, 0x74, 0x6f,
            0x20, 0x54, 0x65, 0x63, 0x68, 0x6e, 0x6f, 0x6c, 0x6f, 0x67, 0x69, 0x65, 0x73, 0x20, 0x53, 0x2e, 0x41, 0x2e,
            0x31, 0x27, 0x30, 0x25, 0x06, 0x03, 0x55, 0x04, 0x0b, 0x13, 0x1e, 0x43, 0x65, 0x72, 0x74, 0x75, 0x6d, 0x20,
            0x43, 0x65, 0x72, 0x74, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x20, 0x41, 0x75, 0x74, 0x68,
            0x6f, 0x72, 0x69, 0x74, 0x79, 0x31, 0x22, 0x30, 0x20, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x19, 0x43, 0x65,
            0x72, 0x74, 0x75, 0x6d, 0x20, 0x54, 0x72, 0x75, 0x73, 0x74, 0x65, 0x64, 0x20, 0x4e, 0x65, 0x74, 0x77, 0x6f,
            0x72, 0x6b, 0x20, 0x43, 0x41, 0x30, 0x82, 0x01, 0x22, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7,
            0x0d, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x82, 0x01, 0x0f, 0x00, 0x30, 0x82, 0x01, 0x0a, 0x02, 0x82, 0x01,
            0x01, 0x00, 0xe3, 0xfb, 0x7d, 0xa3, 0x72, 0xba, 0xc2, 0xf0, 0xc9, 0x14, 0x87, 0xf5, 0x6b, 0x01, 0x4e, 0xe1,
            0x6e, 0x40, 0x07, 0xba, 0x6d, 0x27, 0x5d, 0x7f, 0xf7, 0x5b, 0x2d, 0xb3, 0x5a, 0xc7, 0x51, 0x5f, 0xab, 0xa4,
            0x32, 0xa6, 0x61, 0x87, 0xb6, 0x6e, 0x0f, 0x86, 0xd2, 0x30, 0x02, 0x97, 0xf8, 0xd7, 0x69, 0x57, 0xa1, 0x18,
            0x39, 0x5d, 0x6a, 0x64, 0x79, 0xc6, 0x01, 0x59, 0xac, 0x3c, 0x31, 0x4a, 0x38, 0x7c, 0xd2, 0x04, 0xd2, 0x4b,
            0x28, 0xe8, 0x20, 0x5f, 0x3b, 0x07, 0xa2, 0xcc, 0x4d, 0x73, 0xdb, 0xf3, 0xae, 0x4f, 0xc7, 0x56, 0xd5, 0x5a,
            0xa7, 0x96, 0x89, 0xfa, 0xf3, 0xab, 0x68, 0xd4, 0x23, 0x86, 0x59, 0x27, 0xcf, 0x09, 0x27, 0xbc, 0xac, 0x6e,
            0x72, 0x83, 0x1c, 0x30, 0x72, 0xdf, 0xe0, 0xa2, 0xe9, 0xd2, 0xe1, 0x74, 0x75, 0x19, 0xbd, 0x2a, 0x9e, 0x7b,
            0x15, 0x54, 0x04, 0x1b, 0xd7, 0x43, 0x39, 0xad, 0x55, 0x28, 0xc5, 0xe2, 0x1a, 0xbb, 0xf4, 0xc0, 0xe4, 0xae,
            0x38, 0x49, 0x33, 0xcc, 0x76, 0x85, 0x9f, 0x39, 0x45, 0xd2, 0xa4, 0x9e, 0xf2, 0x12, 0x8c, 0x51, 0xf8, 0x7c,
            0xe4, 0x2d, 0x7f, 0xf5, 0xac, 0x5f, 0xeb, 0x16, 0x9f, 0xb1, 0x2d, 0xd1, 0xba, 0xcc, 0x91, 0x42, 0x77, 0x4c,
            0x25, 0xc9, 0x90, 0x38, 0x6f, 0xdb, 0xf0, 0xcc, 0xfb, 0x8e, 0x1e, 0x97, 0x59, 0x3e, 0xd5, 0x60, 0x4e, 0xe6,
            0x05, 0x28, 0xed, 0x49, 0x79, 0x13, 0x4b, 0xba, 0x48, 0xdb, 0x2f, 0xf9, 0x72, 0xd3, 0x39, 0xca, 0xfe, 0x1f,
            0xd8, 0x34, 0x72, 0xf5, 0xb4, 0x40, 0xcf, 0x31, 0x01, 0xc3, 0xec, 0xde, 0x11, 0x2d, 0x17, 0x5d, 0x1f, 0xb8,
            0x50, 0xd1, 0x5e, 0x19, 0xa7, 0x69, 0xde, 0x07, 0x33, 0x28, 0xca, 0x50, 0x95, 0xf9, 0xa7, 0x54, 0xcb, 0x54,
            0x86, 0x50, 0x45, 0xa9, 0xf9, 0x49, 0x02, 0x03, 0x01, 0x00, 0x01, 0xa3, 0x82, 0x01, 0x6b, 0x30, 0x82, 0x01,
            0x67, 0x30, 0x0f, 0x06, 0x03, 0x55, 0x1d, 0x13, 0x01, 0x01, 0xff, 0x04, 0x05, 0x30, 0x03, 0x01, 0x01, 0xff,
            0x30, 0x1d, 0x06, 0x03, 0x55, 0x1d, 0x0e, 0x04, 0x16, 0x04, 0x14, 0x08, 0x76, 0xcd, 0xcb, 0x07, 0xff, 0x24,
            0xf6, 0xc5, 0xcd, 0xed, 0xbb, 0x90, 0xbc, 0xe2, 0x84, 0x37, 0x46, 0x75, 0xf7, 0x30, 0x52, 0x06, 0x03, 0x55,
            0x1d, 0x23, 0x04, 0x4b, 0x30, 0x49, 0xa1, 0x42, 0xa4, 0x40, 0x30, 0x3e, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03,
            0x55, 0x04, 0x06, 0x13, 0x02, 0x50, 0x4c, 0x31, 0x1b, 0x30, 0x19, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13, 0x12,
            0x55, 0x6e, 0x69, 0x7a, 0x65, 0x74, 0x6f, 0x20, 0x53, 0x70, 0x2e, 0x20, 0x7a, 0x20, 0x6f, 0x2e, 0x6f, 0x2e,
            0x31, 0x12, 0x30, 0x10, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x09, 0x43, 0x65, 0x72, 0x74, 0x75, 0x6d, 0x20,
            0x43, 0x41, 0x82, 0x03, 0x01, 0x00, 0x20, 0x30, 0x0e, 0x06, 0x03, 0x55, 0x1d, 0x0f, 0x01, 0x01, 0xff, 0x04,
            0x04, 0x03, 0x02, 0x01, 0x06, 0x30, 0x2c, 0x06, 0x03, 0x55, 0x1d, 0x1f, 0x04, 0x25, 0x30, 0x23, 0x30, 0x21,
            0xa0, 0x1f, 0xa0, 0x1d, 0x86, 0x1b, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x63, 0x72, 0x6c, 0x2e, 0x63,
            0x65, 0x72, 0x74, 0x75, 0x6d, 0x2e, 0x70, 0x6c, 0x2f, 0x63, 0x61, 0x2e, 0x63, 0x72, 0x6c, 0x30, 0x68, 0x06,
            0x08, 0x2b, 0x06, 0x01, 0x05, 0x05, 0x07, 0x01, 0x01, 0x04, 0x5c, 0x30, 0x5a, 0x30, 0x28, 0x06, 0x08, 0x2b,
            0x06, 0x01, 0x05, 0x05, 0x07, 0x30, 0x01, 0x86, 0x1c, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x73, 0x75,
            0x62, 0x63, 0x61, 0x2e, 0x6f, 0x63, 0x73, 0x70, 0x2d, 0x63, 0x65, 0x72, 0x74, 0x75, 0x6d, 0x2e, 0x63, 0x6f,
            0x6d, 0x30, 0x2e, 0x06, 0x08, 0x2b, 0x06, 0x01, 0x05, 0x05, 0x07, 0x30, 0x02, 0x86, 0x22, 0x68, 0x74, 0x74,
            0x70, 0x3a, 0x2f, 0x2f, 0x72, 0x65, 0x70, 0x6f, 0x73, 0x69, 0x74, 0x6f, 0x72, 0x79, 0x2e, 0x63, 0x65, 0x72,
            0x74, 0x75, 0x6d, 0x2e, 0x70, 0x6c, 0x2f, 0x63, 0x61, 0x2e, 0x63, 0x65, 0x72, 0x30, 0x39, 0x06, 0x03, 0x55,
            0x1d, 0x20, 0x04, 0x32, 0x30, 0x30, 0x30, 0x2e, 0x06, 0x04, 0x55, 0x1d, 0x20, 0x00, 0x30, 0x26, 0x30, 0x24,
            0x06, 0x08, 0x2b, 0x06, 0x01, 0x05, 0x05, 0x07, 0x02, 0x01, 0x16, 0x18, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f,
            0x2f, 0x77, 0x77, 0x77, 0x2e, 0x63, 0x65, 0x72, 0x74, 0x75, 0x6d, 0x2e, 0x70, 0x6c, 0x2f, 0x43, 0x50, 0x53,
            0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x0b, 0x05, 0x00, 0x03, 0x82, 0x01,
            0x01, 0x00, 0x8d, 0xe6, 0xfd, 0x40, 0x66, 0xa3, 0x4c, 0x9c, 0xa7, 0xab, 0xa1, 0xda, 0x84, 0xdd, 0x1c, 0x30,
            0x07, 0xe6, 0xdb, 0xc7, 0x2d, 0xec, 0x83, 0xa1, 0x56, 0xe4, 0x1d, 0x3c, 0x26, 0xa1, 0xa5, 0x09, 0x2b, 0xe8,
            0x7d, 0x62, 0xbe, 0xb2, 0x75, 0x94, 0xdd, 0x08, 0xf2, 0x7f, 0x28, 0x41, 0xe4, 0x80, 0x67, 0x02, 0x4e, 0x8a,
            0x8f, 0xc3, 0x35, 0xd0, 0xd5, 0xa9, 0x27, 0x28, 0xea, 0xd2, 0xf4, 0xab, 0x06, 0x86, 0x43, 0xae, 0x8c, 0xe3,
            0xf9, 0x88, 0x7d, 0xe0, 0xdb, 0xbd, 0x42, 0x81, 0x80, 0x02, 0x12, 0x75, 0xb2, 0xe8, 0x17, 0x71, 0xab, 0x21,
            0x95, 0x31, 0x46, 0x42, 0x0d, 0x88, 0x10, 0x39, 0xd3, 0x6f, 0xec, 0x2f, 0x42, 0xea, 0x40, 0x53, 0x62, 0xbf,
            0xeb, 0xca, 0x78, 0x9e, 0xab, 0xa2, 0xd5, 0x2e, 0x05, 0xea, 0x33, 0xab, 0xe9, 0xd6, 0x97, 0x94, 0x42, 0x5e,
            0x04, 0xed, 0x2c, 0xed, 0x6a, 0x9c, 0x7a, 0x95, 0x7d, 0x05, 0x2a, 0x05, 0x7f, 0x08, 0x5d, 0x66, 0xad, 0x61,
            0xd4, 0x76, 0xac, 0x75, 0x96, 0x97, 0x73, 0x63, 0xbd, 0x1a, 0x41, 0x59, 0x29, 0xa5, 0x5e, 0x22, 0x83, 0xc3,
            0x8b, 0x59, 0xfa, 0x9a, 0xa2, 0xf6, 0xbd, 0x30, 0xbf, 0x72, 0x1d, 0x1c, 0x99, 0x86, 0x9c, 0xf2, 0x85, 0x3c,
            0x1d, 0xf7, 0x26, 0x96, 0x2f, 0x2e, 0xf9, 0x02, 0xb1, 0xb5, 0xa9, 0x50, 0xe8, 0x38, 0xfa, 0x9b, 0x0a, 0x5e,
            0xb4, 0x04, 0xc0, 0xce, 0x4e, 0x39, 0x2c, 0xca, 0x0b, 0x5b, 0x62, 0xf0, 0x4d, 0x58, 0x50, 0x34, 0x99, 0xe6,
            0x9a, 0x2c, 0xd2, 0x90, 0xd7, 0x09, 0x81, 0xd6, 0xc0, 0xaa, 0x5e, 0xce, 0xfe, 0xd2, 0xf7, 0xa1, 0xba, 0x4b,
            0xd9, 0xd6, 0x86, 0x8e, 0x19, 0x1f, 0xa6, 0x06, 0x47, 0x42, 0x72, 0xe0, 0x56, 0x0a, 0x00, 0x1c, 0x78, 0xb9,
            0x8d, 0xcc, 0x99, 0x04, 0x37, 0x49};

    result = lookuper.proceed(DLUPD_INCOMING, IPPROTO_TCP, SERVER_CERT.data(), SERVER_CERT.size());
    ASSERT_EQ(result.status, DLUS_FOUND);
    ASSERT_EQ(result.domain, "ya.ru");
}
